import{G as C,bi as z,bc as $,k as e,bf as ee,bd as Ae,be as De,eK as Fe,dc as Me,j as y,eL as Be,d1 as T,eM as Ee,di as me,cZ as he,s as re,cr as be,a$ as L,V as H,T as b,K as k,eN as te,x as G,cF as _e,W as Ve,a7 as F,a8 as se,av as Y,aj as ne,B as W,at as d,l as Re,dD as Oe,as as ie,eO as ce,H as de,U as Z,eP as We,eo as qe,eh as Ge,el as ze,cg as B,d3 as $e,dQ as le,al as Ke,am as Le,an as He,ao as Qe,ap as Ye,aq as Xe,ar as Ze,p as ge,aP as pe,eQ as Je,eR as er,ch as ue,a5 as rr,cI as tr,eS as sr}from"../entries/pages_catch-all.DeNA4nR9.js";import{B as nr,E as ir}from"./embed-feature-disabled-modal-B8bCtoIe.js";import{S as ar}from"./span-BbxB5wGs.js";import{u as or}from"./use-observable-memo-DwCRw3de.js";import{u as cr,a as j,I as A,W as q}from"./chunk-7ELO524Q-A9cFyVaT.js";const dr=({priceUsd:r,price:t})=>r&&new C(r.replace(/,/g,"")).dividedBy(t.replace(/,/g,"")).toFixed(),lr=({price:r})=>new C(1).dividedBy(r.replace(/,/g,"")).toFixed(),ve=[{type:"priceUsd",types:["priceUsd","priceUsdPercentage","priceUsdCross"]},{type:"priceNative",types:["priceNative"]},{type:"marketCap",types:["marketCap"]}],xe=[{type:"priceUsdInverted",types:["priceUsdInverted","priceUsdInvertedCross"]},{type:"priceNativeInverted",types:["priceNativeInverted"]}],ye=[{type:"moonshotProgress",types:["moonshotProgress"]}],je=[{base:"priceUsd",type:"priceUsd",direction:"over",message:"Goes over",channels:["web","mobile"]},{base:"priceUsd",type:"priceUsd",direction:"under",message:"Goes under",channels:["web","mobile"]},{base:"priceUsd",type:"priceUsdCross",message:"Crosses",channels:["mobile"]},{base:"priceUsd",type:"priceUsdPercentage",message:"Goes up or down",channels:["mobile"]},{base:"priceUsd",type:"priceUsdPercentage",direction:"over",channels:["web"]},{base:"priceUsd",type:"priceUsdPercentage",direction:"under",channels:["web"]},{base:"priceNative",type:"priceNative",direction:"over",message:"Goes over",channels:["web","mobile"]},{base:"priceNative",type:"priceNative",direction:"under",message:"Goes under",channels:["web","mobile"]},{base:"marketCap",type:"marketCap",direction:"over",message:"Goes over",channels:["web","mobile"]},{base:"marketCap",type:"marketCap",direction:"under",message:"Goes under",channels:["web","mobile"]}],fe=[{base:"priceUsdInverted",type:"priceUsdInverted",direction:"over",message:"Goes over",channels:["web","mobile"]},{base:"priceUsdInverted",type:"priceUsdInverted",direction:"under",message:"Goes under",channels:["web","mobile"]},{base:"priceUsdInverted",type:"priceUsdInvertedCross",message:"Crosses",channels:["mobile"]},{base:"priceNativeInverted",type:"priceNativeInverted",direction:"over",message:"Goes over",channels:["web","mobile"]},{base:"priceNativeInverted",type:"priceNativeInverted",direction:"under",message:"Goes under",channels:["web","mobile"]}],ke=[{base:"moonshotProgress",type:"moonshotProgress",direction:"over",message:"Reaches",channels:["web","mobile"]}];var gr={left:{marginEnd:"-1px",borderEndRadius:0,borderEndColor:"transparent"},right:{marginStart:"-1px",borderStartRadius:0,borderStartColor:"transparent"}},pr=z("div",{baseStyle:{flex:"0 0 auto",width:"auto",display:"flex",alignItems:"center",whiteSpace:"nowrap"}}),ae=$(function(t,s){var n;const{placement:a="left",...o}=t,p=(n=gr[a])!=null?n:{},l=cr();return e.jsx(pr,{ref:s,...o,__css:{...l.addon,...p}})});ae.displayName="InputAddon";var D=$(function(t,s){return e.jsx(ae,{ref:s,placement:"left",...t,className:ee("chakra-input__left-addon",t.className)})});D.displayName="InputLeftAddon";D.id="InputLeftAddon";var Q=$(function(t,s){return e.jsx(ae,{ref:s,placement:"right",...t,className:ee("chakra-input__right-addon",t.className)})});Q.displayName="InputRightAddon";Q.id="InputRightAddon";var Ie=r=>e.jsx(z.div,{className:"chakra-stack__divider",...r,__css:{...r.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});Ie.displayName="StackDivider";var Se=$(function(t,s){const{children:n,placeholder:a,className:o,...p}=t;return e.jsxs(z.select,{...p,ref:s,className:ee("chakra-select",o),children:[a&&e.jsx("option",{value:"",children:a}),n]})});Se.displayName="SelectField";function ur(r,t){const s={},n={};for(const[a,o]of Object.entries(r))t.includes(a)?s[a]=o:n[a]=o;return[s,n]}var X=$((r,t)=>{var s;const n=Ae("Select",r),{rootProps:a,placeholder:o,icon:p,color:l,height:v,h:x,minH:c,minHeight:P,iconColor:m,iconSize:I,...f}=De(r),[u,g]=ur(f,Be),i=Fe(g),h={width:"100%",height:"fit-content",position:"relative",color:l},N={paddingEnd:"2rem",...n.field,_focus:{zIndex:"unset",...(s=n.field)==null?void 0:s._focus}};return e.jsxs(z.div,{className:"chakra-select__wrapper",__css:h,...u,...a,children:[e.jsx(Se,{ref:t,height:x??v,minH:c??P,placeholder:o,...i,__css:N,children:r.children}),e.jsx(Ce,{"data-disabled":Me(i.disabled),...(m||l)&&{color:m||l},__css:n.icon,...I&&{fontSize:I},children:p})]})});X.displayName="Select";var mr=r=>e.jsx("svg",{viewBox:"0 0 24 24",...r,children:e.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),hr=z("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),Ce=r=>{const{children:t=e.jsx(mr,{}),...s}=r,n=y.cloneElement(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return e.jsx(hr,{...s,className:"chakra-select__icon-wrapper",children:y.isValidElement(t)?n:null})};Ce.displayName="SelectIcon";const J=r=>{const{pair:t,token:s,formValues:n,isInverted:a,currentMoonshotProgress:o}=r;if(!t&&!s)throw new Error("Neither pair nor token provided.");if(t)switch(n.triggerAndDirection){case"priceUsdValueOver":if(n.priceUsd)return{type:a?"priceUsdInverted":"priceUsd",subject:t,direction:"over",priceUsd:n.priceUsd.replace(/,/g,"")};break;case"priceUsdValueUnder":if(n.priceUsd)return{type:a?"priceUsdInverted":"priceUsd",subject:t,direction:"under",priceUsd:n.priceUsd.replace(/,/g,"")};break;case"priceNativeValueOver":if(n.priceNative)return{type:a?"priceNativeInverted":"priceNative",subject:t,direction:"over",price:n.priceNative.replace(/,/g,"")};break;case"priceNativeValueUnder":if(n.priceNative)return{type:a?"priceNativeInverted":"priceNative",subject:t,direction:"under",price:n.priceNative.replace(/,/g,"")};break;case"priceUsdPercentageOver":if(n.percentage&&n.timeframeKey)return{type:"priceUsdPercentage",subject:t,direction:"over",percentage:new C(n.percentage).decimalPlaces(2).toNumber(),timeframeKey:n.timeframeKey};break;case"priceUsdPercentageUnder":if(n.percentage&&n.timeframeKey)return{type:"priceUsdPercentage",subject:t,direction:"under",percentage:new C(n.percentage).decimalPlaces(2).toNumber(),timeframeKey:n.timeframeKey};break;case"marketCapValueUnder":if(n.marketCap)return{type:"marketCap",subject:t,direction:"under",marketCap:new C(n.marketCap).decimalPlaces(2).toNumber()};break;case"marketCapValueOver":if(n.marketCap)return{type:"marketCap",subject:t,direction:"over",marketCap:new C(n.marketCap).decimalPlaces(2).toNumber()};break}if(s)switch(n.triggerAndDirection){case"moonshotProgressValueOver":case"moonshotProgressValueUnder":if(n.percentage)return{type:"moonshotProgress",subject:s,direction:o&&o<n.percentage?"over":"under",percentage:new C(n.percentage).decimalPlaces(2).toNumber()};break}},Pe=({form:r,currentAlertBases:t,baseTokenSymbol:s})=>{const n=(a,o)=>{switch(a.type){case"priceUsd":case"priceUsdInverted":return"Price in USD";case"priceNative":case"priceNativeInverted":return`Price in ${o}`;case"moonshotProgress":return"Progress";case"marketCap":return"Market Cap"}return""};return e.jsx(j,{as:"span",children:e.jsx(X,{...r.register("triggerBase"),children:t.map(a=>e.jsx("option",{value:a.type,children:n(a,s)},a.type))})})},br=r=>{var f;const{alert:t,dexScreenerPair:s}=r,n=t.trigger.type==="priceUsdInverted"||t.trigger.type==="priceNativeInverted",a=t.trigger.subject.type==="dexToken",o=((u,g)=>u?fe:g?ke:je)(n,a),p=((u,g)=>u?xe:g?ye:ve)(n,a),l=t.trigger.type==="priceUsdInverted"||t.trigger.type==="priceUsd"?t.trigger.priceUsd:s==null?void 0:s.priceUsd,v=t.trigger.type==="priceNative"||t.trigger.type==="priceNativeInverted"?t.trigger.price:s==null?void 0:s.price,x=((f=o.find(u=>u.type===t.trigger.type))==null?void 0:f.base)??"priceUsd",c=t.trigger.type==="marketCap"?t.trigger.marketCap:(s==null?void 0:s.marketCap)??(s==null?void 0:s.fdv),P=t.trigger.type==="priceUsdPercentage"||t.trigger.type==="moonshotProgress"?t.trigger.percentage:void 0,m=t.trigger.type==="priceUsdPercentage"?t.trigger.timeframeKey:void 0;let I="over";return(t.trigger.type==="priceUsd"||t.trigger.type==="priceUsdInverted"||t.trigger.type==="priceNative"||t.trigger.type==="priceNativeInverted"||t.trigger.type==="priceUsdPercentage"||t.trigger.type==="marketCap")&&(I=t.trigger.direction),{isInverted:n,isMoonshot:a,priceUsd:l,priceNative:v,triggerAndDirection:E(t.trigger.type,I),triggerBase:x,percentage:P,timeframeKey:m,marketCap:c,currentAlertTypes:o,currentAlertBases:p}},we=({form:r,quoteTokenSymbol:t="$"})=>{switch(r.watch("triggerBase")){case"priceNative":return e.jsx(j,{as:"div",flex:1,children:e.jsxs(A,{children:[e.jsx(D,{children:t}),e.jsx(T,{isInvalid:!!r.formState.errors.priceNative,...r.register("priceNative",{validate:s=>s?new C(s.replace(/,/g,"")).gt(0):!1})},"TriggerAndDirectionFormPriceNative")]})});case"marketCap":return e.jsx(j,{as:"div",flex:1,children:e.jsxs(A,{children:[e.jsx(D,{children:"$"}),e.jsx(T,{isInvalid:!!r.formState.errors.marketCap,...r.register("marketCap",{validate:s=>s?new C(s).gt(0):!1})},"TriggerAndDirectionFormMarketCap")]})});default:switch(r.watch("triggerAndDirection")){case"priceUsdPercentageOver":case"priceUsdPercentageUnder":return e.jsxs(e.Fragment,{children:[e.jsx(j,{as:"div",flex:1,children:e.jsxs(A,{children:[e.jsx(T,{placeholder:"0",type:"number",step:".01",isInvalid:!!r.formState.errors.percentage,...r.register("percentage",{valueAsNumber:!0,validate:s=>!(!s||s<0||r.getValues("triggerAndDirection")==="priceUsdPercentageUnder"&&s>99.99)})}),e.jsx(Q,{children:"%"})]})}),e.jsx(j,{as:"div",children:"within the"}),e.jsx(j,{as:"div",children:e.jsx(X,{...r.register("timeframeKey"),children:Ee.map(s=>e.jsx("option",{value:s,children:me[s].label},s))})})]});case"moonshotProgressValueUnder":case"moonshotProgressValueOver":return e.jsx(e.Fragment,{children:e.jsx(j,{as:"div",flex:1,children:e.jsxs(A,{children:[e.jsx(T,{placeholder:"0",type:"number",step:".01",isInvalid:!!r.formState.errors.percentage,...r.register("percentage",{valueAsNumber:!0,validate:s=>!(!s||s<0||r.getValues("triggerAndDirection").startsWith("moonshotProgressValue")&&s>99.99)})}),e.jsx(Q,{children:"%"})]})})});default:return e.jsx(j,{as:"div",flex:1,children:e.jsxs(A,{children:[e.jsx(D,{children:"$"}),e.jsx(T,{isInvalid:!!r.formState.errors.priceUsd,...r.register("priceUsd",{validate:s=>s?new C(s.replace(/,/g,"")).gt(0):!1})},"TriggerAndDirectionFormPriceUsd")]})})}}},Ne=({form:r,alertTypes:t,edit:s})=>{var a;const n=o=>{switch(o.type){case"priceUsd":case"priceUsdInverted":case"priceNative":case"priceNativeInverted":case"marketCap":return o.direction==="over"?"Goes over":"Goes under";case"priceUsdCross":case"priceUsdInvertedCross":return"Crosses";case"priceUsdPercentage":return o.direction==="over"?"Goes up more than":"Goes down more than";case"moonshotProgress":return"Reaches"}};return y.useEffect(()=>{!s&&t&&t[0]&&r.setValue("triggerAndDirection",E(t[0].type,t[0].direction))},[(a=t[0])==null?void 0:a.type]),e.jsx(X,{...r.register("triggerAndDirection"),children:t.map(o=>e.jsx("option",{value:E(o.type,o.direction),children:n(o)},E(o.type,o.direction)))})},vr=({alert:r,onSubmit:t,onCancel:s,dexScreenerPair:n})=>{const a=y.useRef(!1),o=br({alert:r,dexScreenerPair:n}),{isInverted:p,isMoonshot:l,priceUsd:v,priceNative:x,triggerBase:c,percentage:P,timeframeKey:m,marketCap:I,triggerAndDirection:f,currentAlertTypes:u,currentAlertBases:g}=o,i=he({defaultValues:{triggerBase:c,triggerAndDirection:f,priceUsd:v,priceNative:x,marketCap:I,percentage:P,note:r.note,timeframeKey:m}}),h=re(),N=F(se),[_,V]=y.useState(!1),M=F(Y),R=y.useCallback(()=>u.filter(w=>w.base===i.watch("triggerBase")&&w.channels.includes("web")),[u,i])();y.useEffect(()=>{if(a.current)return i.setValue("triggerAndDirection",f);a.current=!0},[i,f]);const K=i.handleSubmit(async w=>{if(_)return;let S;if(r.trigger.subject.type==="dexToken"){const U={type:"dexToken",chainId:r.trigger.subject.chainId,dexId:r.trigger.subject.dexId,tokenId:r.trigger.subject.tokenId,baseTokenName:r.trigger.subject.baseTokenName,baseTokenSymbol:r.trigger.subject.baseTokenSymbol,quoteTokenSymbol:r.trigger.subject.quoteTokenSymbol};S=J({token:U,formValues:w,isInverted:p,currentMoonshotProgress:n&&be(n)?n.moonshot.progress:void 0})}else if(r.trigger.subject.type==="dexPair"){const U={type:"dexPair",chainId:r.trigger.subject.chainId,dexId:r.trigger.subject.dexId,pairId:r.trigger.subject.pairId,baseTokenName:r.trigger.subject.baseTokenName,baseTokenSymbol:r.trigger.subject.baseTokenSymbol,quoteTokenSymbol:r.trigger.subject.quoteTokenSymbol};S=J({pair:U,formValues:w,isInverted:p})}if(!S){h({status:"error",description:"Invalid price alert"});return}V(!0);try{await M.actions.updateAlert(r.id,{schemaVersion:"1.0.0",trigger:S,channels:[{type:"browser"}],enabled:!0,note:w.note}),N.track({event:"updatePriceAlert",data:{id:r.id}}),h({status:"success",description:"Price alert updated!"}),t()}catch(U){h({status:"error",description:`Failed updating price alert: ${L(U).message}`})}V(!1)}),O=r.trigger.subject.type==="dexPair"?p?r.trigger.subject.baseTokenSymbol:r.trigger.subject.quoteTokenSymbol:void 0;return e.jsx(e.Fragment,{children:e.jsxs(H,{spacing:4,alignItems:"flex-start",as:"form",onSubmit:K,children:[e.jsxs(q,{style:{height:"inherit"},children:[e.jsx(j,{as:"span",alignItems:"center",children:e.jsx(b,{children:"Alert me when "})}),e.jsx(Pe,{form:i,currentAlertBases:g,baseTokenSymbol:O??""})]}),e.jsxs(q,{align:"center",width:"100%",children:[e.jsx(j,{as:"span",w:"210px",children:e.jsx(Ne,{form:i,alertTypes:R,edit:!0})}),(O||l)&&e.jsx(we,{form:i,quoteTokenSymbol:O})]}),e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(k,{as:te})}),e.jsx(T,{isInvalid:!!i.formState.errors.note,...i.register("note"),placeholder:"Add a note to your alert (optional)"})]}),e.jsx(q,{width:"100%",display:"flex",justifyContent:"end",children:e.jsxs(j,{as:"div",children:[e.jsx(G,{isLoading:_,type:"submit",mr:2,leftIcon:e.jsx(k,{as:_e}),colorScheme:"green",children:"Save"}),e.jsx(G,{onClick:s,leftIcon:e.jsx(k,{as:Ve}),colorScheme:"red",variant:"ghost",children:"Cancel"})]})})]})})},xr=({priceAlert:r})=>{var s;const{colorMode:t}=ne();switch(r.trigger.type){case"priceUsd":return e.jsxs(e.Fragment,{children:["Alert me when price"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",color:r.trigger.direction==="over"?d("green.500","green.400",t):d("red.500","red.400",t),children:[r.trigger.direction==="over"?"goes over":"goes under"," $",B(r.trigger.priceUsd)]})]});case"priceUsdInverted":return e.jsxs(e.Fragment,{children:["Alert me when ",r.trigger.subject.quoteTokenSymbol," price"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",color:r.trigger.direction==="over"?d("green.500","green.400",t):d("red.500","red.400",t),children:[r.trigger.direction==="over"?"goes over":"goes under"," $",B(r.trigger.priceUsd)]})]});case"priceNative":case"priceNativeInverted":return e.jsxs(e.Fragment,{children:["Alert me when ",r.trigger.subject.baseTokenSymbol," price"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",color:r.trigger.direction==="over"?d("green.500","green.400",t):d("red.500","red.400",t),children:[r.trigger.direction==="over"?"goes over":"goes under"," ",B(r.trigger.price)," ",r.trigger.subject.quoteTokenSymbol]})]});case"priceUsdPercentage":return e.jsxs(b,{as:"span",children:["Alert me when price is"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",color:r.trigger.direction==="over"?d("green.500","green.400",t):d("red.500","red.400",t),children:[r.trigger.direction==="over"?"goes up more than":"goes down more than"," ",B(r.trigger.percentage),"%"]})," ","within the"," ",e.jsx(W,{as:"span",fontWeight:"semibold",children:(s=me[r.trigger.timeframeKey])==null?void 0:s.label.toLowerCase()})]});case"marketCap":return e.jsxs(e.Fragment,{children:["Alert me when market cap"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",color:r.trigger.direction==="over"?d("green.500","green.400",t):d("red.500","red.400",t),children:[r.trigger.direction==="over"?"goes over":"goes under"," $",B(r.trigger.marketCap)]})]});case"moonshotProgress":return e.jsxs(b,{as:"span",children:["Alert me when moonshot progress"," ",e.jsxs(b,{as:"span",fontWeight:"semibold",children:["Reaches ",B(r.trigger.percentage),"%"]})," "]});default:return null}},yr=({priceAlerts:r,containerProps:t,showPair:s,dexScreenerPair:n,onPairClick:a})=>{const o=F(Y),{actions:p}=o,[l,v]=y.useState(void 0),x=re(),{colorMode:c}=ne(),P=i=>{try{p.resetAlert(i),x({status:"success",description:"Price alert reset"})}catch(h){x({status:"error",description:`Failed resetting price alert: ${L(h).message}`})}},m=i=>{try{p.deleteAlert(i)}catch(h){x({status:"error",description:`Failed deleting price alert: ${L(h).message}`})}},I=i=>{v({type:"edit",id:i.id})},f=()=>{v(void 0)},u=()=>{v(void 0)},g=()=>{v(void 0)};return e.jsx(H,{spacing:3,alignItems:"stretch",...t,children:r.map(i=>{if(i.trigger.subject.type!=="dexPair"&&i.trigger.subject.type!=="dexToken")return;const h=l&&l.type==="edit"&&l.id===i.id,N=l&&l.type==="delete"&&l.id===i.id;return e.jsxs(W,{borderWidth:1,borderColor:h?d("gray.100","gray.800",c):d("gray.50","gray.925",c),p:3,bg:h?d("gray.0","blue.950",c):d("gray.50","gray.925",c),borderRadius:"md",children:[s&&e.jsx(Re,{display:"block",w:"100%",to:Oe({platformId:i.trigger.subject.chainId,pairAddress:i.trigger.subject.type==="dexPair"?i.trigger.subject.pairId:i.trigger.subject.type==="dexToken"?i.trigger.subject.tokenId:""}),onClick:a?()=>a():void 0,mb:3,pb:2,borderBottomWidth:1,borderBottomColor:d("gray.100","gray.800",c),_hover:{textDecoration:"none",borderBottomColor:d("gray.150","gray.750",c)},children:e.jsxs(b,{as:"span",fontSize:{base:"sm",md:"md"},children:[e.jsx(b,{as:"span",fontWeight:"semibold",children:i.trigger.subject.baseTokenSymbol}),e.jsx(b,{as:"span",mx:"2px",color:d("gray.400","gray.500",c),children:"/"}),e.jsx(b,{as:"span",color:d("gray.400","gray.500",c),children:i.trigger.subject.quoteTokenSymbol}),e.jsx(b,{as:"span",display:{base:"none",md:"initial"},ml:3,children:i.trigger.subject.baseTokenName})]})}),e.jsxs(W,{display:"flex",alignItems:"center",justifyContent:"space-between",...i.note&&{pb:2},children:[e.jsxs(W,{width:"100%",children:[e.jsxs(W,{wordBreak:"break-all",children:[e.jsxs(b,{as:"span",display:"flex",alignItems:"center",mb:1,fontWeight:"semibold",textTransform:"uppercase",fontSize:"xs",color:i.enabled?d("green.500","green.400",c):d("red.500","red.400",c),children:[e.jsx(k,{as:ie,mr:"3px"}),i.enabled?"Active":"Disabled"]}),h&&e.jsx(vr,{alert:i,dexScreenerPair:n,onSubmit:f,onCancel:u}),!h&&e.jsx(xr,{priceAlert:i})]}),!h&&e.jsxs(b,{as:"span",fontSize:"sm",color:d("gray.400","gray.600",c),children:["Created ",ce(i.createdAt)," ago",i.triggeredAt&&`, last triggered ${ce(i.triggeredAt)} ago`]})]}),!h&&e.jsxs(de,{children:[!i.enabled&&e.jsx(Z,{onClick:()=>P(i.id),"aria-label":"Reset alert",title:"Reset alert",icon:e.jsx(k,{as:We}),flexShrink:0,variant:"unstyled",colorScheme:"red",size:"sm",ml:3,color:d("gray.500","gray.600",c),_hover:{color:d("green.600","green.300",c)}}),e.jsx(Z,{onClick:()=>I(i),variant:"unstyled",flexShrink:0,size:"sm",ml:3,title:"Edit alert","aria-label":"Edit alert",icon:e.jsx(k,{as:qe}),color:d("gray.500","gray.600",c),_hover:{color:d("accent.500","accent.400",c)}}),e.jsx(Z,{onClick:()=>v({type:"delete",id:i.id}),"aria-label":"Delete alert",title:"Delete alert",icon:e.jsx(k,{as:Ge}),flexShrink:0,variant:"unstyled",colorScheme:"red",size:"sm",ml:3,color:d("gray.500","gray.600",c),_hover:{color:d("red.500","red.400",c)}})]})]}),!h&&i.note&&e.jsx(e.Fragment,{children:e.jsxs(H,{alignItems:"flex-start",children:[e.jsx(Ie,{borderTopWidth:1,borderColor:d("gray.100","blue.900",c)}),e.jsxs(de,{spacing:2,justifyContent:"flex-start",alignItems:"center",children:[e.jsx(k,{as:te,color:d("gray.400","gray.600",c)}),e.jsx(b,{as:"span",fontSize:"sm",color:d("gray.500","gray.300",c),children:i.note})]})]})}),N&&e.jsx(ze,{modalProps:{onClose:()=>g()},message:"Are you sure you want to delete this alert?",onConfirm:()=>m(i.id),onCancel:()=>g()})]},i.id)})})},E=(r,t)=>r==="priceUsdCross"||r==="priceNativeInverted"||r==="priceUsdInvertedCross"||r==="newScreenerPair"||r==="watchlistPriceUsdPercentage"?r:r==="priceUsd"||r==="priceNative"||r==="marketCap"?`${r}Value${t?le(t):""}`:`${r}${t?le(t):""}`,jr=({pair:r,isInverted:t})=>{const s=y.useRef(!0),{price:n,priceUsd:a,chainId:o,pairAddress:p,dexId:l,quoteToken:v,baseToken:x,marketCap:c,fdv:P}=r,m=be(r),I=y.useMemo(()=>m?r.moonshot.progress:0,[m,r]),f=y.useCallback(()=>t?xe:m?ye:ve,[t,m])(),u=y.useCallback(()=>t?fe:m?ke:je,[t,m])(),g=he({defaultValues:{triggerBase:f[0].type,triggerAndDirection:E(u[0].type,u[0].direction?u[0].direction:void 0),priceUsd:t?dr({price:n,priceUsd:a}):a,priceNative:t?lr({price:n}):n,percentage:m?I:0,marketCap:c??P??0,note:void 0}}),i=y.useCallback(()=>u.filter(S=>S.base===g.watch("triggerBase")&&S.channels.includes("web")),[u,g])(),h=re(),N=F(se),[_,V]=y.useState(!1),M=F(Y),R=or(()=>m?M.listAlertsByToken(o,l,r.baseToken.address):M.listAlertsByPair(o,l,r.pairAddress),[M,o,l,r.pairAddress,r.baseToken.address,m],[]),{setValue:K}=g;y.useEffect(()=>()=>{s.current=!1},[s]),y.useEffect(()=>{K("triggerAndDirection",E(u[0].type,u[0].direction?u[0].direction:void 0))},[K,u]);const O=g.handleSubmit(async S=>{if(_)return;const U={type:"dexPair",chainId:o,dexId:l,pairId:p,baseTokenName:x.name,baseTokenSymbol:x.symbol,quoteTokenSymbol:v.symbol},Ue={type:"dexToken",chainId:o,dexId:l,tokenId:x.address,baseTokenName:x.name,baseTokenSymbol:x.symbol,quoteTokenSymbol:v.symbol},oe=J({pair:m?void 0:U,token:m?Ue:void 0,formValues:S,isInverted:t,currentMoonshotProgress:m?r.moonshot.progress:void 0});if(!oe){h({status:"error",description:"Invalid price alert"});return}V(!0);try{await M.actions.createAlert({schemaVersion:"1.0.0",trigger:oe,channels:[{type:"browser"}],enabled:!0,note:S.note}),N.track({event:"addPriceAlert"}),h({status:"success",description:"Price alert created!"}),s.current&&(g.setValue("priceUsd",void 0),g.setValue("priceNative",void 0),g.setValue("marketCap",void 0),g.setValue("percentage",void 0),g.setValue("note",null))}catch(Te){h({status:"error",description:`Failed creating price alert: ${L(Te).message}`})}V(!1)}),w=t?x.symbol:v.symbol;return e.jsxs(e.Fragment,{children:[e.jsxs(H,{spacing:4,alignItems:"flex-start",as:"form",onSubmit:O,children:[e.jsxs(q,{style:{height:"inherit"},children:[e.jsx(j,{as:"span",alignItems:"center",children:e.jsx(b,{children:"Alert me when "})}),e.jsx(Pe,{form:g,currentAlertBases:f,baseTokenSymbol:r.baseToken.symbol})]}),e.jsxs(q,{align:"center",width:"100%",children:[e.jsx(j,{as:"span",w:"210px",children:e.jsx(Ne,{form:g,alertTypes:i})}),e.jsx(we,{form:g,quoteTokenSymbol:w}),e.jsx(j,{as:"div",children:e.jsx(G,{isLoading:_,type:"submit",leftIcon:e.jsx(k,{as:$e}),colorScheme:"green",children:"Create Alert"})})]}),e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(k,{as:te})}),e.jsx(T,{isInvalid:!!g.formState.errors.note,...g.register("note"),placeholder:"Add a note to your alert (optional)"})]})]}),R&&R.length>0&&e.jsx(yr,{dexScreenerPair:r,containerProps:{mt:5},priceAlerts:R})]})},fr=({pair:r,onClose:t,isInverted:s})=>{const[n,a]=y.useState();y.useEffect(()=>{"Notification"in window&&a(window.Notification.permission)},[]);const o=()=>{"Notification"in window&&window.Notification.requestPermission(l=>{a(l)})},{colorMode:p}=ne();return e.jsxs(Ke,{size:"3xl",onClose:t,motionPreset:"none",scrollBehavior:"inside",blockScrollOnMount:!1,isOpen:!0,children:[e.jsx(Le,{}),e.jsxs(He,{children:[e.jsx(Qe,{}),e.jsx(Ye,{children:e.jsx(Xe,{size:"md",children:"Manage Price Alerts"})}),e.jsxs(Ze,{p:5,children:[n==="default"&&e.jsxs(ge,{display:"flex",flexDir:"column",py:6,textAlign:"center",children:[e.jsxs(b,{fontSize:"lg",children:["To set price alerts please enable"," ",e.jsx(pe,{href:"https://support.google.com/chrome/answer/3220216?hl=en&co=GENIE.Platform%3DDesktop",target:"_blank",rel:"noreferrer",color:d("accent.600","accent.200",p),textDecor:"underline",children:"browser notifications"})," ","for DEX Screener first:"]}),e.jsx(G,{mt:4,onClick:o,colorScheme:"green",leftIcon:e.jsx(k,{as:ie}),size:"lg",children:"Enable Notifications"})]}),n==="denied"&&e.jsxs(ge,{display:"flex",flexDir:"column",py:6,textAlign:"center",children:[e.jsx(k,{as:Je,color:d("red.500","red.400",p),boxSize:"80px"}),e.jsxs(b,{mt:4,fontSize:"lg",children:["You have blocked notifications for DEX Screener. Please"," ",e.jsx(pe,{href:"https://support.google.com/chrome/answer/3220216?hl=en&co=GENIE.Platform%3DDesktop",target:"_blank",rel:"noreferrer",color:d("accent.600","accent.200",p),textDecor:"underline",children:"change your browser settings"}),", reload this page and try again."]})]}),n==="granted"&&e.jsx(jr,{pair:r,isInverted:s})]})]})]})},wr=({pair:r,buttonProps:t,isInverted:s})=>{const n=F(se),{isEmbed:a}=er(c=>c.embedSettings),o=ue(),p=ue(),l=F(Y),v=rr(l.active,[]).filter(({trigger:c})=>c.subject.type==="dexPair"&&c.subject.chainId===(r==null?void 0:r.chainId)&&c.subject.pairId===r.pairAddress||c.subject.type==="dexToken"&&c.subject.chainId===(r==null?void 0:r.chainId)&&c.subject.tokenId===r.baseToken.address).length,x=()=>{if(a){o.onOpen();return}p.onOpen(),n.track({event:"priceAlertsButtonClick"})};return e.jsxs(e.Fragment,{children:[e.jsx(tr,{isDisabled:t&&!t.isDisabled,label:"Your device does not support notifications",children:e.jsxs(G,{onClick:x,leftIcon:e.jsx(k,{as:v===0?sr:ie,boxSize:"16px"}),fontWeight:"normal",pointerEvents:r?void 0:"none",_focus:{boxShadow:"none"},...t,children:[e.jsx(ar,{children:"Alerts"}),v>0&&e.jsx(nr,{label:v})]})}),r&&p.isOpen&&e.jsx(fr,{pair:r,onClose:p.onClose,isInverted:s}),o.isOpen&&e.jsx(ir,{onClose:o.onClose})]})};export{D as I,wr as P,Ie as S,yr as a,Q as b,lr as c,dr as i};
