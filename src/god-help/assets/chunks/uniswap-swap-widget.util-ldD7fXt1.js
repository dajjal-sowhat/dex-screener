import{aV as _e,hY as wt,ah as At,hZ as Et,ag as Ct,gk as Dt,y as we,cS as nt,h_ as Nt,a9 as qe,h$ as _t,bC as ue,cV as Ft,gJ as jt,dV as bn,cz as jn,dU as Rt,i0 as Bt,eH as C,he as H,i1 as Rn,i2 as Ot,bb as en,bc as fe,bd as vn,be as nn,i3 as tn,k as o,bi as he,bf as Te,K as ke,fU as Ut,i4 as Wt,j as l,i5 as Mt,br as qt,dd as gn,i6 as Lt,de as Vt,bg as $t,i7 as zt,B as de,b1 as In,P as Kt,T as ge,i8 as Gt,cy as tt,i9 as Ht,a2 as Qt,a3 as Xt,ia as Yt,a_ as Zt,fv as Jt,aa as es,aj as De,ac as ns,dJ as ts,p as ss,at as G,bK as os,E as pn,x as Ee,d9 as as,ec as Be,aP as Ze,b$ as Bn,ib as rs,bn as is,cI as cs,V as Ie,H as Me,bE as Ne,g1 as Pn,bz as j,ct as ls,ic as us,ay as se,bt as st,s as wn,id as ds,ie as ms,cj as bs,bA as re,c0 as Le,hJ as Je,hk as ot,ig as hs,I as at,M as gs,J as ps,U as An,hC as fs,N as Ss,ej as On,ih as ys,ii as ks,h2 as rt,ij as Ts,ik as xs,il as vs,bO as Is,ek as Ps,im as it,io as ws,ip as As,iq as ct,bF as Es,ir as ye,h8 as le,bB as Un,hd as ze,h7 as D,bW as fn,c_ as Cs,cT as Wn,e7 as Ds,d4 as Ns,a7 as te,cZ as _s,is as Fs,h9 as js,it as Rs,hp as Bs,ho as Mn,bR as Ve,dr as Os,ds as Us,al as Ws,am as Ms,an as qs,ap as Ls,aq as Vs,ao as $s,ar as zs,bP as Ks,gK as Ke,ba as Gs,iu as sn,G as W,bx as on,a$ as an,aZ as En,hb as Hs,hc as qn,iv as Ln,hf as Qs,hg as Xs,hh as Ys,hi as Zs,hj as Js}from"../entries/pages_catch-all.DeNA4nR9.js";import{e as eo,E as no,B as to,c as Cn,a as so}from"./ErrorMessageServerConnection-O3DygrcT.js";import{D as oo}from"./delayed-Cer_z3Z7.js";import{u as ao,b as ro,a as io}from"./conditional-wrap-CI4-c_vk.js";import{u as co,I as lo,W as uo}from"./chunk-7ELO524Q-A9cFyVaT.js";import{S as ve}from"./span-BbxB5wGs.js";import{a as Vn}from"./index.esm-DdF9dPvy.js";function mo(e){return _e(function(){return e})}function bo(e,n){return wt(function(s,t){return At(e(s,t)).pipe(Et(1),mo(s))})}function ho(e,n){n===void 0&&(n=Dt);var s=Ct(e,n);return bo(function(){return s})}const Ce=Symbol("NoData"),Ja=e=>e!==Ce,$n=e=>e===Ce,go=we({webSocketClientFactory:Nt,logger:qe,reconnectionStrategy:_t},({webSocketClientFactory:e,logger:n,reconnectionStrategy:s})=>t=>e.create.pipe(nt(a=>{const{serializer:r,url:i}=t,c=a({serializer:r,url:i,reconnectionStrategy:s,logger:n,binaryType:t.binaryType});return new Ft(h=>{const b=new jt({status:c.status,data:Ce}),d=c.message.subscribe({next:I=>b.next({data:I,status:c.status})}),f=b.subscribe(h),T=c.connect();return()=>{d.unsubscribe(),f.unsubscribe(),T()}})}))),er=(e,n)=>{const s=a=>!n.data||n.data===Ce?bn({data:a.data,status:n.status}):jn(n),t=()=>{switch(n.status){case"closed":case"reconnecting":return!n.data||n.data===Ce?Bt(new Error("Can not reach the server!")):bn(n);case"connected":return jn(n);default:return!n.data||n.data===Ce?Rt:bn(n)}};return ue({value:e,onFailure:t,onFailureWithData:s,onPending:t,onPendingWithData:s,onSuccess:s})},po=we(()=>({calculateCost:e=>{try{const{amount:n,buyType:s,direction:t,curvePosition:a,curve:r}=e;if(t==="buy"&&s==="quote")return r.getTokensNumberFromCollateral({curvePosition:C(a),direction:t,collateralAmount:H(n,r.getConfig().collateralDecimalsNr)});if(t==="sell"){const i=H(n,r.getConfig().tokenDecimalsNr);let c;return r.getConfig().type==="LINEAR_V1"?c=C(a).minus(i):c=C(a),r.getCollateralPriceForTokens({curvePosition:c.lt(0)?C(0):c,tokenAmount:i,direction:t})}return r.getCollateralPriceForTokens({curvePosition:C(a),tokenAmount:H(n,r.getConfig().tokenDecimalsNr),direction:t})}catch{return}},getTokensNumberFromCollateral:e=>{try{const{amount:n,curve:s,curvePosition:t,direction:a}=e;return s.getTokensNumberFromCollateral({curvePosition:C(t),direction:a,collateralAmount:H(n,s.getConfig().collateralDecimalsNr)})}catch{return}}})),fo=e=>{if(e==="base")return"0xA103455889D4e22600c208D6125E0E7673106695";if(e==="basesepolia")return"0xF2Bb405d183A2492b352Ef47befD7f32dD9C3980"};function So(){const e=Rn(()=>({current:null,animations:[]})),n=Rn(()=>eo(e));return Ot(()=>{e.animations.forEach(s=>s.stop())}),[e,n]}var[yo,ko]=en({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),lt=fe((e,n)=>{const s=vn("FormError",e),t=nn(e),a=tn();return a!=null&&a.isInvalid?o.jsx(yo,{value:s,children:o.jsx(he.div,{...a==null?void 0:a.getErrorMessageProps(t,n),className:Te("chakra-form__error-message",e.className),__css:{display:"flex",alignItems:"center",...s.text}})}):null});lt.displayName="FormErrorMessage";var To=fe((e,n)=>{const s=ko(),t=tn();if(!(t!=null&&t.isInvalid))return null;const a=Te("chakra-form__error-icon",e.className);return o.jsx(ke,{ref:n,"aria-hidden":!0,...e,__css:s.icon,className:a,children:o.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});To.displayName="FormErrorIcon";var Sn=fe(function(n,s){var t;const a=Ut("FormLabel",n),r=nn(n),{className:i,children:c,requiredIndicator:u=o.jsx(ut,{}),optionalIndicator:h=null,...b}=r,d=tn(),f=(t=d==null?void 0:d.getLabelProps(b,s))!=null?t:{ref:s,...b};return o.jsxs(he.label,{...f,className:Te("chakra-form__label",r.className),__css:{display:"block",textAlign:"start",...a},children:[c,d!=null&&d.isRequired?u:h]})});Sn.displayName="FormLabel";var ut=fe(function(n,s){const t=tn(),a=Wt();if(!(t!=null&&t.isRequired))return null;const r=Te("chakra-form__required-indicator",n.className);return o.jsx(he.span,{...t==null?void 0:t.getRequiredIndicatorProps(n,s),__css:a.requiredIndicator,className:r})});ut.displayName="RequiredIndicator";var xo=he("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),rn=fe(function(n,s){var t,a;const{placement:r="left",...i}=n,c=co(),u=c.field,b={[r==="left"?"insetStart":"insetEnd"]:"0",width:(t=u==null?void 0:u.height)!=null?t:u==null?void 0:u.h,height:(a=u==null?void 0:u.height)!=null?a:u==null?void 0:u.h,fontSize:u==null?void 0:u.fontSize,...c.element};return o.jsx(xo,{ref:s,__css:b,...i})});rn.id="InputElement";rn.displayName="InputElement";var Dn=fe(function(n,s){const{className:t,...a}=n,r=Te("chakra-input__left-element",t);return o.jsx(rn,{ref:s,placement:"left",className:r,...a})});Dn.id="InputLeftElement";Dn.displayName="InputLeftElement";var Nn=fe(function(n,s){const{className:t,...a}=n,r=Te("chakra-input__right-element",t);return o.jsx(rn,{ref:s,placement:"right",className:r,...a})});Nn.id="InputRightElement";Nn.displayName="InputRightElement";var dt=fe(function(n,s){const t=vn("Switch",n),{spacing:a="0.5rem",children:r,...i}=nn(n),{getIndicatorProps:c,getInputProps:u,getCheckboxProps:h,getRootProps:b,getLabelProps:d}=ao(i),f=l.useMemo(()=>({display:"inline-block",position:"relative",verticalAlign:"middle",lineHeight:0,...t.container}),[t.container]),T=l.useMemo(()=>({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer",...t.track}),[t.track]),I=l.useMemo(()=>({userSelect:"none",marginStart:a,...t.label}),[a,t.label]);return o.jsxs(he.label,{...b(),className:Te("chakra-switch",n.className),__css:f,children:[o.jsx("input",{className:"chakra-switch__input",...u({},s)}),o.jsx(he.span,{...h(),className:"chakra-switch__track",__css:T,children:o.jsx(he.span,{__css:t.thumb,className:"chakra-switch__thumb",...c()})}),r&&o.jsx(he.span,{className:"chakra-switch__label",...d(),__css:I,children:r})]})});dt.displayName="Switch";var[vo,Io,Po,wo]=Mt();function Ao(e){var n;const{defaultIndex:s,onChange:t,index:a,isManual:r,isLazy:i,lazyBehavior:c="unmount",orientation:u="horizontal",direction:h="ltr",...b}=e,[d,f]=l.useState(s??0),[T,I]=qt({defaultValue:s??0,value:a,onChange:t});l.useEffect(()=>{a!=null&&f(a)},[a]);const p=Po(),w=l.useId();return{id:`tabs-${(n=e.id)!=null?n:w}`,selectedIndex:T,focusedIndex:d,setSelectedIndex:I,setFocusedIndex:f,isManual:r,isLazy:i,lazyBehavior:c,orientation:u,descendants:p,direction:h,htmlProps:b}}var[Eo,cn]=en({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function Co(e){const{focusedIndex:n,orientation:s,direction:t}=cn(),a=Io(),r=l.useCallback(i=>{const c=()=>{var R;const N=a.nextEnabled(n);N&&((R=N.node)==null||R.focus())},u=()=>{var R;const N=a.prevEnabled(n);N&&((R=N.node)==null||R.focus())},h=()=>{var R;const N=a.firstEnabled();N&&((R=N.node)==null||R.focus())},b=()=>{var R;const N=a.lastEnabled();N&&((R=N.node)==null||R.focus())},d=s==="horizontal",f=s==="vertical",T=i.key,I=t==="ltr"?"ArrowLeft":"ArrowRight",p=t==="ltr"?"ArrowRight":"ArrowLeft",B={[I]:()=>d&&u(),[p]:()=>d&&c(),ArrowDown:()=>f&&c(),ArrowUp:()=>f&&u(),Home:h,End:b}[T];B&&(i.preventDefault(),B(i))},[a,n,s,t]);return{...e,role:"tablist","aria-orientation":s,onKeyDown:gn(e.onKeyDown,r)}}function Do(e){const{isDisabled:n=!1,isFocusable:s=!1,...t}=e,{setSelectedIndex:a,isManual:r,id:i,setFocusedIndex:c,selectedIndex:u}=cn(),{index:h,register:b}=wo({disabled:n&&!s}),d=h===u,f=()=>{a(h)},T=()=>{c(h),!r&&!(n&&s)&&a(h)};return{...Lt({...t,ref:Vt(b,e.ref),isDisabled:n,isFocusable:s,onClick:gn(e.onClick,f)}),id:mt(i,h),role:"tab",tabIndex:d?0:-1,type:"button","aria-selected":d,"aria-controls":bt(i,h),onFocus:n?void 0:gn(e.onFocus,T)}}var[No,_o]=en({});function nr(e){const n=cn(),{id:s,selectedIndex:t}=n,r=$t(e.children).map((i,c)=>l.createElement(No,{key:c,value:{isSelected:c===t,id:bt(s,c),tabId:mt(s,c),selectedIndex:t}},i));return{...e,children:r}}function tr(e){const{children:n,...s}=e,{isLazy:t,lazyBehavior:a}=cn(),{isSelected:r,id:i,tabId:c}=_o(),u=l.useRef(!1);r&&(u.current=!0);const h=zt({wasSelected:u.current,isSelected:r,enabled:t,mode:a});return{tabIndex:0,...s,children:h?n:null,role:"tabpanel","aria-labelledby":c,hidden:!r,id:i}}function mt(e,n){return`${e}--tab-${n}`}function bt(e,n){return`${e}--tabpanel-${n}`}var[Fo,ht]=en({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),jo=fe(function(n,s){const t=vn("Tabs",n),{children:a,className:r,...i}=nn(n),{htmlProps:c,descendants:u,...h}=Ao(i),b=l.useMemo(()=>h,[h]),{isFitted:d,...f}=c,T={position:"relative",...t.root};return o.jsx(vo,{value:u,children:o.jsx(Eo,{value:b,children:o.jsx(Fo,{value:t,children:o.jsx(he.div,{className:Te("chakra-tabs",r),ref:s,...f,__css:T,children:a})})})})});jo.displayName="Tabs";var Ro=fe(function(n,s){const t=Co({...n,ref:s}),r={display:"flex",...ht().tablist};return o.jsx(he.div,{...t,className:Te("chakra-tabs__tablist",n.className),__css:r})});Ro.displayName="TabList";var Bo=fe(function(n,s){const t=ht(),a=Do({...n,ref:s}),r={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...t.tab};return o.jsx(he.button,{...a,className:Te("chakra-tabs__tab",n.className),__css:r})});Bo.displayName="Tab";const Oo={backgroundColor:["rgba(255, 255, 255, 0)","rgba(255, 215, 13, 0.3)","rgba(255, 255, 255, 0)"],transition:{ease:"easeOut",duration:1}},sr=({children:e,display:n,animateOn:s="update",value:t,animationDefinition:a=Oo})=>{const[r,i]=So(),c=l.useRef(!0);return l.useEffect(()=>{(s==="mount"&&c.current===!0||s==="update"&&c.current===!1)&&i(r.current,a),c.current===!0&&(c.current=!1)},[t,i,r,a,s,c]),o.jsx(de,{ref:r,display:n,children:e})},Uo=({children:e,status:n,...s})=>{const t={info:{bg:In("gray.600","gray.750")},error:{bg:"red.500",color:"white"}};return o.jsx(Kt,{children:o.jsx(de,{pos:"fixed",w:{base:"100vw",md:"initial"},bottom:{base:0,md:5},right:{md:5},borderRadius:{md:"md"},fontSize:"md",boxShadow:"md",py:2,px:4,zIndex:"tooltip",...t[n],...s,children:e})})},Wo=()=>o.jsx(Uo,{status:"error",children:o.jsxs(ge,{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",children:[o.jsx(ke,{as:Gt,mr:"6px"}),"Disconnected from server, attempting to reconnect..."]})}),[Mo,qo]=tt("DEXScreenerPair"),[or,ar]=Ht("PairDetailsEntity");class ln extends Error{constructor(n){super(n),this.name="PairsServiceUnsupportedSchemaError",Object.setPrototypeOf(this,ln.prototype)}}class _n extends Error{constructor(n){super(n),this.name="PairsServiceDisconnectedError",Object.setPrototypeOf(this,_n.prototype)}}const rr=we({getWebSocketData:go,servers:Jt,dexScreenerWSSHost:es},({getWebSocketData:e,servers:n,dexScreenerWSSHost:s})=>({getPair:t=>{const a=new URL(s);a.pathname=`/dex/screener/v4/pair/${t.chainId}/${t.pairId.toLowerCase()}`;const{uniswapScreenerServer:r}=n;return e({url:a,serializer:Qt(Yt,Xt()),binaryType:"arraybuffer"}).pipe(nt(({data:i,status:c})=>{if(!i||i===Ce)return Zt({data:i,status:c.getValue()});switch(i.type){case"pair":{if(r.schemaVersion!==i.schemaVersion)throw new ln(`${i.schemaVersion} is not supported (${r.schemaVersion})`);return c.pipe(_e(u=>({status:u,data:i.pair??void 0})))}}}))}})),ir=({pairCreatedAt:e,containerProps:n})=>{var i,c;const{colorMode:s}=De(),t=((i=ns().current)==null?void 0:i.time)??Date.now();if(!e||!((t-e)/1e3/60/60<=24))return null;const r=((c=ts(e,{now:t}))==null?void 0:c.split(" ")[0])??void 0;return o.jsxs(ss,{color:G("green.700","green.300",s),fontSize:"xs",fontWeight:"semibold",...n,children:[o.jsx(ke,{as:os,mr:"2px"}),r]})},Lo=({children:e,...n})=>o.jsxs(pn,{...n,emoji:"⌛",title:"You're using an outdated version of DEX Screener",children:[o.jsxs(ge,{children:["Please"," ",o.jsx(Ee,{variant:"link",onClick:()=>window.location.reload(),colorScheme:"accent",children:"refresh this page"})," ","to update to the latest version"]}),e]}),cr=({children:e,onClose:n,pair:s,showDisconnectAlert:t})=>{const a=l.useCallback(()=>o.jsx(as,{loaderProps:{label:"Loading pair..."}}),[]),r=l.useCallback(u=>u instanceof _n?o.jsx(no,{children:n&&o.jsx(Be,{onClick:n,pos:"absolute",top:2,right:2,autoFocus:!0})}):u instanceof ln?o.jsx(Lo,{children:n&&o.jsx(Be,{onClick:n,pos:"absolute",top:2,right:2,autoFocus:!0})}):o.jsxs(pn,{title:"Woops!",children:[o.jsx(ge,{children:"We had problems receiveing pair you're looking for."}),o.jsxs(ge,{mt:2,children:["If you think this is an error,"," ",o.jsx(Ze,{href:Bn,target:"_blank",rel:"noopener noreferrer",textDecor:"underline",children:"please get in touch with us!"})]}),n&&o.jsx(Be,{onClick:n,pos:"absolute",top:2,right:2,autoFocus:!0})]}),[n]),i=l.useCallback(()=>o.jsxs(pn,{title:"Token or Pair Not Found",children:[o.jsx(ge,{children:"We can't seem to find the token or pair you're looking for."}),o.jsxs(ge,{mt:2,children:["If you think this is an error,"," ",o.jsx(Ze,{href:Bn,target:"_blank",rel:"noopener noreferrer",textDecor:"underline",children:"please get in touch with us!"})]}),n&&o.jsx(Be,{onClick:n,pos:"absolute",top:2,right:2,autoFocus:!0})]}),[n]),c=l.useCallback(u=>{if(!u.data||$n(u.data))switch(u.status){case"closed":case"reconnecting":return r();case"connected":return $n(u.data)?a():i();default:return a()}return o.jsxs(o.Fragment,{children:[t&&(u.status==="reconnecting"||u.status==="closed")&&o.jsx(oo,{delay:1e4,children:o.jsx(Wo,{})}),e({pair:u.data})]})},[e,r,i,a,t]);return ue({value:s,onPending:a,onFailure:r,onSuccess:c})};function Vo(e,n,s){return rs(is(e,"UNKNOWN_BREAKPOINT")??n,s)}const $o=({children:e,labelContainerProps:n,...s})=>{const[t,a]=l.useState(!1);return o.jsx(cs,{isOpen:s.isDisabled?void 0:t,bg:"gray.950",borderColor:"gray.975",color:"white",...s,children:o.jsx(de,{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:()=>a(!0),...n,children:e})})},zo=()=>o.jsx(ge,{as:"span",color:In("gray.300","gray.600"),fontWeight:"normal",children:"N/A"}),Ko={borderless:{borderWidth:0,padding:0,textAlign:void 0,alignItems:"flex-start"},outline:{borderWidth:1,paddingX:"5px",paddingY:"3px",textAlign:"center"}},Go=({children:e,label:n,labelProps:s,tooltipProps:t,variant:a="borderless",...r})=>{const{colorMode:i}=De();return o.jsxs(Ie,{borderColor:G("gray.75","blue.900",i),borderRadius:"md",spacing:"2px",flex:1,alignItems:"stretch",...Ko[a],...r,children:[n&&o.jsx(ro,{if:t!==void 0,with:c=>o.jsx($o,{fontSize:"xs",textAlign:"center",labelContainerProps:{lineHeight:"14px"},...t,children:c}),children:o.jsx(ge,{as:"span",fontSize:"xs",fontWeight:"normal",mt:"1px",lineHeight:"14px",color:G("gray.350","gray.525",i),textTransform:"uppercase",...t!==void 0?{cursor:"help",borderBottomWidth:1,borderBottomColor:G("gray.300","gray.600",i),borderBottomStyle:"dashed"}:void 0,...s,children:n})}),e??o.jsx(zo,{})]})},lr=({children:e,label:n,labelProps:s,tooltipProps:t,fontSize:a,variant:r="borderless",...i})=>o.jsx(Go,{variant:r,label:n,labelProps:s,tooltipProps:t,...i,children:e&&o.jsx(ge,{as:"span",fontSize:a,children:e})}),ur=({labels:e})=>o.jsx(Me,{spacing:"1",children:e.map(n=>o.jsx(de,{as:"span",children:o.jsx(to,{fontSize:"2xs",children:n})},n))}),Ho=j.object({serializedTx:j.string(),token:j.string()}),Qo=j.string(),Xo=j.object({status:j.enum(["SUCCESS","FAILED","PENDING"]),transactionSignature:j.string()}),Yo=we({env:Ne(),httpClient:Pn},({env:e,httpClient:n})=>({meteoraSwapPrepareV1:({sender:s,poolId:t,mintFrom:a,mintTo:r,amountIn:i,amountOut:c,feeAmount:u,feeMintAddress:h,traceId:b})=>{const d=new URL(`${e.DS_METEORA_SWAP_API_PUBLIC_ORIGIN}/v1/meteora-swap/prepare`);return n.post(d.toString(),Ho,{headers:{"content-type":"application/json","X-SESSION_HASH":b},body:{sender:s,poolId:t,mintFrom:a,mintTo:r,feeMintAddress:h,amountIn:i,amountOut:c,feeAmount:u}})},meteoraSwapGetPriceV1:({poolId:s,mintFrom:t,mintTo:a,amountIn:r})=>{const i=new URL(`${e.DS_METEORA_SWAP_API_PUBLIC_ORIGIN}/v1/meteora-swap/price`);return n.post(i.toString(),Qo,{headers:{"content-type":"application/json"},body:{poolId:s,mintFrom:t,mintTo:a,amountIn:r}})},meteoraSwapSubmitV1:({signedTransaction:s,token:t,traceId:a})=>{const r=new URL(`${e.DS_METEORA_SWAP_API_PUBLIC_ORIGIN}/v1/meteora-swap/submit`);return n.post(r.toString(),Xo,{headers:{"content-type":"application/json","X-SESSION_HASH":a},body:{signedTransaction:s,token:t}})}})),Zo=j.object({serializedTx:j.string(),token:j.string()}),Jo=j.string(),ea=j.object({status:j.enum(["SUCCESS","FAILED","PENDING"]),transactionSignature:j.string()}),na=we({env:Ne(),httpClient:Pn},({env:e,httpClient:n})=>({raydiumSwapPrepareV1:({sender:s,poolId:t,mintFrom:a,mintTo:r,amountIn:i,amountOut:c,feeAmount:u,feeMintAddress:h,slippageBps:b,swapType:d,traceId:f,priority:T})=>{const I=new URL(`${e.DS_RAYDIUM_SWAP_API_PUBLIC_ORIGIN}/v1/raydium-swap/prepare`);return n.post(I.toString(),Zo,{headers:{"content-type":"application/json","X-SESSION_HASH":f},body:{sender:s,poolId:t,mintFrom:a,mintTo:r,feeMintAddress:h,amountIn:i,amountOut:c,feeAmount:u,slippageBps:b,swapType:d,priority:T}})},raydiumSwapGetPriceV1:({poolId:s,mintFrom:t,mintTo:a,amountIn:r})=>{const i=new URL(`${e.DS_RAYDIUM_SWAP_API_PUBLIC_ORIGIN}/v1/raydium-swap/price`);return n.post(i.toString(),Jo,{headers:{"content-type":"application/json"},body:{poolId:s,mintFrom:t,mintTo:a,amountIn:r}})},raydiumSwapSubmitV1:({signedTransaction:s,token:t,traceId:a})=>{const r=new URL(`${e.DS_RAYDIUM_SWAP_API_PUBLIC_ORIGIN}/v1/raydium-swap/submit`);return n.post(r.toString(),ea,{headers:{"content-type":"application/json","X-SESSION_HASH":a},body:{signedTransaction:s,token:t}})}})),ta=j.object({serializedTx:j.string(),token:j.string()}),sa=j.string(),oa=j.object({status:j.enum(["SUCCESS","FAILED","PENDING"]),transactionSignature:j.string()}),aa=we({env:Ne(),httpClient:Pn},({env:e,httpClient:n})=>({uniswapBaseSwapPrepareV1:({sender:s,poolId:t,mintFrom:a,mintTo:r,amountIn:i,amountOut:c,feeAmount:u,feeMintAddress:h,slippageBps:b,swapType:d,traceId:f})=>{const T=new URL(`${e.DS_UNISWAP_SWAP_API_PUBLIC_ORIGIN}/v1/uniswap/prepare/base`);return n.post(T.toString(),ta,{headers:{"content-type":"application/json","X-SESSION_HASH":f},body:{sender:s,poolId:t,mintFrom:a,mintTo:r,feeMintAddress:h,amountIn:i,amountOut:c,feeAmount:u,slippageBps:b,swapType:d}})},uniswapBaseSwapGetPriceV1:({poolId:s,mintFrom:t,mintTo:a,amountIn:r,traceId:i})=>{const c=new URL(`${e.DS_UNISWAP_SWAP_API_PUBLIC_ORIGIN}/v1/uniswap/price/base`);return n.post(c.toString(),sa,{headers:{"content-type":"application/json","X-SESSION_HASH":i},body:{poolId:s,mintFrom:t,mintTo:a,amountIn:r}})},uniswapBaseSwapSubmitV1:({signedTransaction:s,token:t,traceId:a})=>{const r=new URL(`${e.DS_UNISWAP_SWAP_API_PUBLIC_ORIGIN}/v1/uniswap/confirm/base`);return n.post(r.toString(),oa,{headers:{"content-type":"application/json","X-SESSION_HASH":a},body:{signedTransaction:s,token:t}})}})),ra=e=>{var n;return e.chainId==="solana"&&e.dexId==="meteora"&&((n=e.labels)==null?void 0:n.includes("DYN"))===!0&&!!e.baseToken.decimals&&!!e.quoteToken.decimals},ia=e=>e.chainId==="solana"&&e.dexId==="raydium"&&(!e.labels||e.labels.length===0)&&e.baseToken.decimals!==void 0&&e.quoteToken.decimals!==void 0,ca=e=>ls(e)&&(e.chainId==="base"||e.chainId==="basesepolia")&&e.dexId==="uniswap"&&us(e.labels??[],"v2")&&!!e.baseToken.decimals&&!!e.quoteToken.decimals,la=e=>{if(e==="base")return"0x2a3ccB70316b78972C5F987E0464E9DbaDa6DCEe";if(e==="basesepolia")return"0x03604b23E08A3bFb3f7e7A4A4d5745999ceDa2aA"},ua=({copyText:e,onClick:n,toastText:s,...t})=>{const a=se(e),[,r]=st(),i=wn(),c=l.useCallback(u=>{n==null||n(u),r(a.current),s&&i({status:"success",description:s,isClosable:!0})},[a,r,n,i,s]);return o.jsx(Ee,{rightIcon:o.jsx(ke,{as:ds}),...t,onClick:c})},da=e=>{switch(e){case"lg":return"4";case"md":return"3";case"sm":return"2";case"xs":return"1";default:return"2"}},gt=l.forwardRef((e,n)=>{const{size:s,leftElementProps:t,rightElementProps:a,leftElement:r,rightElement:i,isInvalid:c,...u}=e,h=!!r,b=l.useRef(null),d=h?"100px":void 0,f=da(s);return o.jsxs(lo,{size:s,children:[h?o.jsx(Dn,{width:"auto",maxWidth:d,pl:f,pointerEvents:"none",...t,children:r}):null,o.jsx(ms,{ref:n,size:s,fontSize:"1rem",fontWeight:"semibold",paddingLeft:d,isInvalid:c,paddingRight:i&&b.current?`${b.current.clientWidth}px`:void 0,...u}),i?o.jsx(Nn,{ref:b,width:"auto",maxWidth:"24",paddingX:f,...a,children:i}):null]})}),ma=e=>{const n=bs(e.chainId),s=re(p=>p.connect),t=re(p=>p.disconnectWallet),a=re(p=>p.connectedWallets),r=ot(e.chainId),i=r?a[r]:void 0,c=Le(async()=>i==null?void 0:i.adapter.getPublicKey(),[i]),u=se(c),[,h]=st(),b=wn(),d=l.useCallback(()=>{if(!u.current)return;const p=ue({value:u.current,onPending:()=>{},onFailure:()=>{},onSuccess:Je});p&&(h(p),b({status:"success",description:"Address copied to clipboard",isClosable:!0}))},[h,b,u]),f=l.useCallback(()=>{const p=n==null?void 0:n.nativeChainId;s(r,p)},[s,n==null?void 0:n.nativeChainId,r]),T=l.useCallback(()=>{r&&t(r)},[t,r]),I=l.useCallback(async()=>{if(!((n==null?void 0:n.nativeChainId)===void 0||!i))return i.adapter.switchChain({nativeChainId:n.nativeChainId})},[n==null?void 0:n.nativeChainId,i]);return{isConnected:i!==void 0,connectWallet:f,disconnectWallet:T,walletAddress:ue({value:c,onPending:()=>{},onFailure:()=>{},onSuccess:Je}),copyAddressToClipboard:d,switchChain:I}},ba=({type:e,state:n,onClick:s,isDisabled:t,chainId:a})=>{const{isConnected:r,connectWallet:i,disconnectWallet:c,walletAddress:u,copyAddressToClipboard:h,switchChain:b}=ma({chainId:a}),d=l.useCallback(()=>{b().then(()=>s())},[s,b]);return o.jsx(hs,{children:r?o.jsxs(at,{size:"sm",colorScheme:e==="buy"?"moonshot":"red",width:"100%",isAttached:!0,children:[o.jsx(Ee,{isDisabled:n==="error"||n==="pending"||t,isLoading:n==="pending",loadingText:"Processing...",textTransform:"uppercase",flex:"1",onClick:d,children:e}),o.jsxs(gs,{children:[o.jsx(ps,{as:An,icon:o.jsx(ke,{as:Vn}),"aria-label":"More",opacity:n==="error"||n==="pending"||t?.4:void 0}),o.jsx(fs,{children:o.jsxs(Ss,{children:[u&&o.jsx(On,{onClick:h,children:ys(u,6,6)}),o.jsx(On,{icon:o.jsx(ke,{as:ks}),onClick:c,children:"Disconnect"})]})})]})]}):o.jsx(Ee,{size:"sm",colorScheme:e==="buy"?"moonshot":"red",textTransform:"uppercase",isDisabled:t,leftIcon:o.jsx(ke,{as:Vn}),onClick:i,flex:"1",children:"Connect wallet"})})},yn=({children:e,...n})=>{const{colorMode:s}=De(),t=G("gray.100","blue.850",s);return o.jsx(Ie,{alignItems:"stretch",flex:"1",spacing:"0",borderRadius:"md",borderWidth:1,borderColor:t,...n,children:e})},kn=({presets:e,onPresetClick:n,isPresetsDisabled:s})=>{const{colorMode:t}=De(),a=G("gray.75","whiteAlpha.100",t),r=G("gray.125","blackAlpha.400",t);return e.length>0?o.jsx(at,{isAttached:!0,borderTopWidth:1,borderTopColor:a,isDisabled:s,sx:{button:{borderRadius:0},"button:not(:last-of-type)":{borderRightWidth:1,borderRightColor:r}},children:e.map(({value:i,label:c})=>o.jsx(Ee,{size:"xs",flex:"1",bg:G("gray.25","whiteAlpha.50",t),color:G("gray.500","blue.400",t),fontSize:"2xs",fontWeight:"normal",_hover:{bg:G("gray.75","whiteAlpha.200",t)},onClick:()=>n(i),children:c},i))}):null},ha=e=>{const{error:n}=rt();return o.jsx(vs,{...e,isInvalid:e.isInvalid||n!==void 0})},zn=e=>{const{error:n}=rt();return n!=null&&n.message?o.jsx(lt,{...e,children:n==null?void 0:n.message}):null},Kn=({children:e,isRequired:n,isInvalid:s})=>o.jsx(Ts,{children:o.jsx(ha,{isRequired:n,isInvalid:s,children:e})}),dr=e=>{const n=xs(),s=In("red.500","red.300");return o.jsx(io,{color:n!==void 0?s:void 0,...e})},Pe=(e,n,s)=>s?e.multipliedBy(n.dividedBy(100).plus(1)):e.dividedBy(n.dividedBy(100).plus(1)),Tn=(e,n)=>{const s=G("red.400","red.300",n),t=G("gray.700","blue.300",n),a=G("white","blackAlpha.150",n),r=G("white","blackAlpha.300",n),i=G("gray.975","white",n);return{borderRadius:"none",border:0,borderColor:"transparent",boxShadow:"none",color:e?t:s,_hover:{bg:a},_focus:{boxShadow:"none",bg:r,color:e?i:s},_invalid:{boxShadow:"none"}}},pt=l.forwardRef((e,n)=>{const{direction:s,buyType:t,onBuyTypeToggle:a,currentTokenImageURL:r,quoteTokenSymbol:i,baseTokenSymbol:c,leftElementProps:u,rightElementProps:h,rightElement:b,...d}=e,f=s==="buy"&&t==="quote"?i:c,T=f||r,I=`Switch to ${t==="quote"?c:i}`;return o.jsx(gt,{ref:n,leftElement:T?o.jsxs(Me,{spacing:"1",mr:2,minWidth:"0",opacity:d.isDisabled?.5:void 0,children:[r&&o.jsx(Is,{src:r,w:"16px",h:"16px",flexShrink:0,loading:"lazy"}),f&&o.jsx(ve,{fontWeight:"semibold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:f})]}):null,leftElementProps:u,rightElement:b===void 0&&s==="buy"?o.jsx(An,{onClick:a,icon:o.jsx(ke,{as:Ps}),title:I,"aria-label":I,size:"xs",isDisabled:d.isDisabled}):null,rightElementProps:h,...d})});var Gn=function(e,n,s){if(e&&"reportValidity"in e){var t=it(s,n);e.setCustomValidity(t&&t.message||""),e.reportValidity()}},ft=function(e,n){var s=function(a){var r=n.fields[a];r&&r.ref&&"reportValidity"in r.ref?Gn(r.ref,a,e):r.refs&&r.refs.forEach(function(i){return Gn(i,a,e)})};for(var t in n.fields)s(t)},ga=function(e,n){n.shouldUseNativeValidation&&ft(e,n);var s={};for(var t in e){var a=it(n.fields,t);ws(s,t,Object.assign(e[t]||{},{ref:a&&a.ref}))}return s},pa=function(e,n){for(var s={};e.length;){var t=e[0],a=t.code,r=t.message,i=t.path.join(".");if(!s[i])if("unionErrors"in t){var c=t.unionErrors[0].errors[0];s[i]={message:c.message,type:c.code}}else s[i]={message:r,type:a};if("unionErrors"in t&&t.unionErrors.forEach(function(b){return b.errors.forEach(function(d){return e.push(d)})}),n){var u=s[i].types,h=u&&u[t.code];s[i]=As(i,n,s,a,h?[].concat(h,t.message):t.message)}e.shift()}return s},fa=function(e,n,s){return s===void 0&&(s={}),function(t,a,r){try{return Promise.resolve(function(i,c){try{var u=Promise.resolve(e[s.mode==="sync"?"parse":"parseAsync"](t,n)).then(function(h){return r.shouldUseNativeValidation&&ft({},r),{errors:{},values:s.raw?t:h}})}catch(h){return c(h)}return u&&u.then?u.then(void 0,c):u}(0,function(i){if(function(c){return c.errors!=null}(i))return{values:{},errors:ga(pa(i.errors,!r.shouldUseNativeValidation&&r.criteriaMode==="all"),r)};throw i}))}catch(i){return Promise.reject(i)}}};const mr=ct(["sell","buy"]);ct(["base","quote"]);const pe={idle:{kind:"idle"},pending:{kind:"pending"}},[xn,Sa]=tt("SwapWidgetContext"),ya=!1,ka=j.object({slippage:j.string(),isFrontRunningProtectionEnabled:j.boolean(),frontRunningProtectionFee:j.string()}),Ta="@dexscreener/swap-widget",xa="2",va=[],Ia=e=>`${Ta}/v${xa}/${e}`,Pa=Ne(),un=({amountPresets:e,slippagePresets:n,children:s,options:t,calculateCost:a,getBaseTokenBalance:r,getQuoteTokenBalance:i,submitTransaction:c,swapDirection:u})=>{const b=te(Pa).DS_WEB_SWAP_WIDGET_BLOXROUTE_ENABLED,d=l.useMemo(()=>({...t,isSettingsEnabled:b?t.isSettingsEnabled:!1}),[b,t]),f=l.useMemo(()=>({slippage:d==null?void 0:d.slippage,isFrontRunningProtectionEnabled:b?ya:!1,frontRunningProtectionFee:`${d.defaultPriorityFee}`}),[b,d.defaultPriorityFee,d==null?void 0:d.slippage]),{state:T,setState:I}=Es({key:Ia(d.widgetId),schema:ka,defaultState:f,localKeys:va}),[p,w]=l.useState(u??"buy"),[B,R]=l.useState("quote"),[N,v]=l.useState(d.buyQuoteAmount),[L,Z]=l.useState(d.buyBaseAmount),[oe,ie]=l.useState(d.sellQuoteAmount),[$,z]=l.useState(f.slippage),[S,g]=l.useState(pe.idle),[m,y]=l.useState(f.isFrontRunningProtectionEnabled),[k,V]=l.useState(f.frontRunningProtectionFee),M=p==="buy"&&B==="base",X=p==="buy"?B==="quote"?N:L:oe,O=ye(X),Y=ye($),q=a({amount:O,swapDirection:p,swapMode:B}),A=q?le(q,M?d.baseTokenDecimals:d.quoteTokenDecimals):void 0,F=A?Pe(A,Y,M):void 0,_=Un(()=>r(),[r]),E=Un(()=>i(),[i]),U=[],Q=!O.isNaN()&&O.toNumber()>=0,ee=!Y.isNaN(),ae=p==="buy"&&Q?ue({value:E,onPending:ze,onFailure:ze,onSuccess:P=>P===void 0?!0:B==="quote"?O.lte(P):ye(N).lte(P)}):void 0,x=p==="sell"&&Q?ue({value:_,onPending:ze,onFailure:ze,onSuccess:P=>P?O.lte(P):!0}):void 0,K=p==="buy"?C(N).gte(d.minBuyAmount)||C(N).eq(0):void 0,ce=p==="sell"&&A?A.gte(d.minSellAmount)||A.eq(0):void 0;Q||U.push("invalid-amount"),ee||U.push("invalid-slippage"),Y.lt(d.minSlippage)&&U.push("min-slippage"),Y.gt(d.maxSlippage)&&U.push("max-slippage"),F!==void 0&&F.isNaN()&&U.push("invalid-amount-with-slippage"),ae===!1&&U.push("not-enough-collateral"),x===!1&&U.push("not-enough-token"),K===!1&&U.push("min-buy-amount"),ce===!1&&U.push("min-sell-amount");const me=U.length>0,Ae=U.findIndex(P=>P==="not-enough-collateral"||P==="not-enough-token")===-1,Se=se(d),J=se(p),be=se(B),xe=l.useCallback(()=>R(P=>P==="base"?"quote":"base"),[]),Fe=l.useCallback(P=>{switch(J.current){case"buy":{if(be.current==="quote"){v(P);const ne=a({amount:ye(P),swapMode:be.current,swapDirection:J.current});ne&&ne.isNaN()===!1&&Z(new D(le(ne,Se.current.quoteTokenDecimals)).toString());return}if(be.current==="base"){Z(P);const ne=a({amount:ye(P),swapMode:be.current,swapDirection:J.current});ne&&ne.isNaN()===!1&&v(new D(le(ne,Se.current.baseTokenDecimals)).toString())}return}case"sell":return ie(P)}},[a,Se,J,be]),St=l.useCallback(P=>{v(P);const ne=a({amount:ye(P),swapMode:"quote",swapDirection:"buy"});ne&&ne.isNaN()===!1&&Z(new D(le(ne,Se.current.quoteTokenDecimals)).toString())},[a,Se]),yt=l.useCallback(P=>{ue({value:_,onPending:fn,onFailure:fn,onSuccess:ne=>{if(ne===void 0)return;const $e=new D(ne).multipliedBy(P/100);if($e.isNaN())return;const mn=d.adjustPercentageSellAmount??(({sellAmount:Pt})=>Pt.toFixed());ie(mn({sellAmount:$e,percentage:P}))}})},[_,d.adjustPercentageSellAmount]),Fn=Cs(P=>P.pipe(ho(1),Wn(ne=>{g(pe.idle),ne.resetSellAmount===!0&&J.current==="sell"&&ie("0")})),[J]),kt=l.useCallback(async()=>{g(pe.pending);const P=Ds();try{const{resetTxState:ne,resetSellAmount:$e,...mn}=await c({slippage:$,amount:X,swapDirection:p,swapMode:B,traceId:P,isFrontRunningProtectionEnabled:m,priorityFee:k});g(mn),ne&&Fn({resetSellAmount:$e===!0})}catch{g({kind:"error"})}},[c,$,X,p,B,m,k,Fn]),Tt=l.useCallback(P=>{z(P),I({slippage:P})},[I]),xt=l.useCallback(P=>{y(P),I({isFrontRunningProtectionEnabled:P})},[I]),vt=l.useCallback(P=>{V(P),I({frontRunningProtectionFee:P})},[I]);l.useEffect(()=>{u&&w(u)},[u]),Ns(()=>T.pipe(Wn(P=>{z(P.slippage),V(P.frontRunningProtectionFee),y(b?P.isFrontRunningProtectionEnabled:!1)})),[b,T]);const It={swapDirection:p,setSwapDirection:w,swapMode:B,toggleSwapMode:xe,currentAmount:X,amountPresets:e[p],setCurrentAmount:Fe,slippage:$,slippagePresets:n[p],setSlippage:Tt,setBuyAmountInQuoteValue:St,setSellAmountAsPercentage:yt,baseTokenBalance:_,quoteTokenBalance:E,errors:U,hasFunds:Ae,hasError:me,options:d,txState:S,initiateTransaction:kt,receiveOrSpendWithSlippage:F==null?void 0:F.toNumber(),isFrontRunningProtectionEnabled:m,setIsFrontRunningProtectionEnabled:xt,frontRunningProtectionFee:k,setFrontRunningProtectionFee:vt,defaultTradeSettings:f};return o.jsx(Sa,{value:It,children:s})},wa=j.object({frontrunningProtection:j.boolean(),priorityFee:j.unknown().transform(e=>{const n=Fs.stringToFloat(js(`${e}`));return isNaN(n)?0:n})}).superRefine((e,n)=>{e.priorityFee<0&&n.addIssue({code:"custom",message:"Priority fee can not be lower than 0.",path:["priorityFee"]})}),Aa=({data:e})=>{const n=xn(h=>h.options.minPriorityFee),s=xn(h=>h.options.priorityFeePresets),t=l.useMemo(()=>fa(wa.superRefine((h,b)=>{h.frontrunningProtection&&h.priorityFee<n&&b.addIssue({code:"custom",message:`Priority fee can not be lower than ${n} when front running protection is enabled.`,path:["priorityFee"]})})),[n]),a=_s({resolver:t,defaultValues:{frontrunningProtection:e.frontrunningProtection,priorityFee:C(e.priorityFee).toNumber()}}),r=a.getFieldState("priorityFee").error===void 0,i=l.useCallback(h=>a.setValue("priorityFee",h),[a]),c=1*10**-Rs(n),u=Mo(Je);return{form:a,step:c,pair:u,priorityFeePresets:s,isPriorityFeeValid:r,setPriorityFee:i,minPriorityFee:n}},Ea=({data:e,onCancel:n,onSubmit:s})=>{const t=te(Ve),{form:a,step:r,pair:i,priorityFeePresets:c,isPriorityFeeValid:u,setPriorityFee:h,minPriorityFee:b}=Aa({data:e}),{colorMode:d}=De(),f=l.useCallback(T=>{s(T)},[s]);return o.jsx(Bs,{...a,children:o.jsx("form",{onSubmit:a.handleSubmit(f),noValidate:!0,children:o.jsxs(Ie,{alignItems:"stretch",spacing:"6",children:[o.jsx(Mn,{control:a.control,name:"frontrunningProtection",render:({field:T})=>o.jsxs(Kn,{children:[o.jsxs(Ie,{alignItems:"stretch",children:[o.jsxs(Me,{justifyContent:"center",children:[o.jsx(Sn,{flex:"1",marginBottom:"0",children:"Front running protection"}),o.jsx(dt,{ref:T.ref,isChecked:T.value,onChange:T.onChange,onBlur:T.onBlur,colorScheme:"green"})]}),o.jsxs(ge,{fontSize:"sm",color:G("gray.500","blue.500",d),children:["Front-running protection prevents"," ",o.jsx(Ze,{href:"https://www.coinbase.com/learn/crypto-glossary/what-are-sandwich-attacks-in-crypto",target:"_blank",variant:"link",rel:"noopener noreferrer",color:G("black","whiteAlpha.800",d),children:"sandwich"})," ","attacks on your swaps. With this feature enabled you can safely use high slippage."]})]}),o.jsx(zn,{})]})}),o.jsx(Mn,{control:a.control,name:"priorityFee",render:({field:T})=>o.jsxs(Kn,{children:[o.jsxs(Ie,{alignItems:"stretch",children:[o.jsxs(de,{children:[o.jsx(Sn,{children:"Priority fee"}),o.jsxs(yn,{children:[o.jsx(pt,{ref:T.ref,baseTokenSymbol:i.baseToken.symbol,quoteTokenSymbol:i.quoteToken.symbol,currentTokenImageURL:t(i.chainId),onBuyTypeToggle:fn,rightElement:null,direction:"buy",buyType:"quote",onChange:T.onChange,onBlur:T.onBlur,step:r,value:`${T.value}`,min:b,isInvalid:!u,...Tn(u,d)}),o.jsx(kn,{presets:c,onPresetClick:h})]})]}),o.jsx(ge,{fontSize:"sm",color:G("gray.500","blue.500",d),children:"A higher priority fee will speed up the confirmation of your transactions."})]}),o.jsx(zn,{})]})}),o.jsxs(Me,{justifyContent:"center",children:[o.jsx(Ee,{type:"submit",variant:"solid",colorScheme:"moonshot",children:"Save"}),o.jsx(Ee,{onClick:n,variant:"ghost",children:"Cancel"})]})]})})})},Ca=()=>{const{value:e,enable:n,disable:s}=Os(!1);return{isModalVisible:e,showModal:n,hideModal:s}},Da=({isSettingsOverwritten:e,data:n,onSubmit:s})=>{const{isModalVisible:t,showModal:a,hideModal:r}=Ca(),i=l.useCallback(c=>{r(),s(c)},[r,s]);return o.jsxs(de,{children:[o.jsxs(de,{position:"relative",children:[o.jsx(An,{"aria-label":"Transaction settings",onClick:a,size:"sm",icon:o.jsx(ke,{as:Us})}),e?o.jsx(de,{position:"absolute",borderRadius:"full",width:"7px",height:"7px",background:"green.500",right:"4px",top:"4px",pointerEvents:"none"}):null]}),t?o.jsxs(Ws,{isOpen:!0,onClose:r,size:"sm",children:[o.jsx(Ms,{}),o.jsxs(qs,{children:[o.jsx(Ls,{children:o.jsx(Vs,{size:"md",children:"Trade Settings"})}),o.jsx($s,{}),o.jsx(zs,{paddingY:"6",children:o.jsx(Ea,{data:n,onSubmit:i,onCancel:r})})]})]}):null]})},Na=e=>{if(!(e.priceUsd===void 0||e.value===void 0))switch(e.swapDirection){case"buy":{switch(e.swapMode){case"base":{const n=C(e.priceUsd).dividedBy(e.price);return C(e.value).multipliedBy(n).toNumber()}case"quote":return C(e.value).multipliedBy(e.priceUsd).toNumber()}break}case"sell":{const n=C(e.priceUsd).dividedBy(e.price);return C(e.value).multipliedBy(n).toNumber()}}},_a=({pair:e})=>{const{swapDirection:n,setSwapDirection:s,swapMode:t,toggleSwapMode:a,amountPresets:r,slippagePresets:i,setCurrentAmount:c,currentAmount:u,slippage:h,setSlippage:b,setBuyAmountInQuoteValue:d,setSellAmountAsPercentage:f,baseTokenBalance:T,quoteTokenBalance:I,errors:p,hasError:w,hasFunds:B,options:R,txState:N,initiateTransaction:v,receiveOrSpendWithSlippage:L,isFrontRunningProtectionEnabled:Z,setIsFrontRunningProtectionEnabled:oe,frontRunningProtectionFee:ie,setFrontRunningProtectionFee:$,defaultTradeSettings:z}=xn(Je),S=re(O=>O.connectedWallets.solana!==void 0||O.connectedWallets.evm!==void 0),g=Na({price:e.price,priceUsd:e.priceUsd,swapDirection:n,swapMode:t,value:L}),m=R.isSettingsEnabled,y=l.useMemo(()=>({frontrunningProtection:Z,priorityFee:C(ie).toNumber()}),[ie,Z]),k=l.useMemo(()=>({frontrunningProtection:z.isFrontRunningProtectionEnabled,priorityFee:C(z.frontRunningProtectionFee).toNumber()}),[z.frontRunningProtectionFee,z.isFrontRunningProtectionEnabled]),V=Ks(k,y)===!1,M=l.useCallback(O=>{oe(O.frontrunningProtection),$(`${O.priorityFee}`)},[$,oe]),X=R.buySwapModes.includes("base");return{swapDirection:n,setSwapDirection:s,swapMode:t,toggleSwapMode:a,receiveOrSpend:L,receiveOrSpendInUsd:g,amountPresets:r,slippagePresets:i,currentAmount:u,setCurrentAmount:c,setBuyAmountInQuoteValue:d,slippage:h,setSlippage:b,errors:p,hasError:w,hasFunds:B,isSlippageValid:p.findIndex(O=>O==="invalid-slippage")===-1,isAmountValid:p.findIndex(O=>O==="invalid-amount")===-1,initiateTransaction:v,txState:N,quoteTokenBalance:I,baseTokenBalance:T,setSellAmountAsPercentage:f,isAmountPresetsDisabled:n==="sell"&&!S,options:R,isSettingsEnabled:m,isSettingsOverwritten:V,transactionSettings:y,onTransactionSettingsChange:M,isBuyBaseModeEnabled:X}},Hn=e=>{const{colorMode:n}=De(),s=G("red.400","red.300",n),t=e.variant==="success"?G("moonshot.650","moonshot.850",n):s,a=e.variant==="success"?"moonshot.accent.text":s;return o.jsxs(de,{background:G("moonshot.25","moonshot.1000",n),padding:{base:2,md:3},borderRadius:"md",borderWidth:"1px",borderColor:t,position:"relative",children:[e.isClosable&&o.jsx(Be,{onClick:e.onClose,size:"sm",position:"absolute",right:"1",top:"1",border:"0"}),o.jsxs(Ie,{spacing:"1",children:[e.title&&o.jsx(ve,{fontWeight:"semibold",color:a,children:e.title}),e.description&&o.jsx(ve,{children:e.description}),o.jsxs(uo,{justify:"center",children:[e.blockExplorerLink&&o.jsx(Ee,{as:Ze,size:"sm",href:e.blockExplorerLink,target:"_blank",variant:"ghost",rel:"noopener noreferrer",sx:{"&:hover":{textDecoration:"none"}},rightIcon:o.jsx(ke,{as:Gs}),iconSpacing:"1.5",fontWeight:"normal",children:"Open in block explorer"}),e.variant==="error"&&e.traceId?o.jsx(ua,{size:"sm",variant:"outline",copyText:e.traceId,toastText:"Trace ID copied!",children:"Copy Trace ID"}):null]})]})]})},dn=({pair:e,isDisabled:n,buildTokenImageURL:s})=>{const{swapDirection:t,swapMode:a,receiveOrSpend:r,receiveOrSpendInUsd:i,amountPresets:c,slippagePresets:u,currentAmount:h,slippage:b,setCurrentAmount:d,setSlippage:f,hasError:T,hasFunds:I,baseTokenBalance:p,quoteTokenBalance:w,isSlippageValid:B,isAmountValid:R,initiateTransaction:N,txState:v,toggleSwapMode:L,setBuyAmountInQuoteValue:Z,setSellAmountAsPercentage:oe,isAmountPresetsDisabled:ie,errors:$,options:z,isSettingsEnabled:S,isSettingsOverwritten:g,transactionSettings:m,onTransactionSettingsChange:y,isBuyBaseModeEnabled:k}=_a({pair:e}),V=Vo({base:!1,md:!0},!1,!1),{colorMode:M}=De(),X=G("gray.500","blue.500",M),O=G("red.400","red.300",M),Y=G("gray.700","blue.300",M),q=wn(),A=l.useRef(null),F=l.useRef(null),_=se(t),E=l.useCallback(x=>d(x),[d]),U=l.useCallback(x=>{var K;if((K=A.current)==null||K.focus(),_.current==="buy"){Z(`${x}`);return}oe(x)},[_,Z,oe]),Q=l.useCallback(x=>f(x),[f]),ee=l.useCallback(x=>{var K;f(`${x}`),(K=F.current)==null||K.focus()},[f]),ae=l.useCallback(()=>{var x;L(),(x=A.current)==null||x.focus()},[L]);return l.useEffect(()=>{switch(v.kind){case"idle":case"pending":return;case"success":{q({status:"success",isClosable:!0,position:"bottom-right",duration:3e4,render:x=>o.jsx(Hn,{...x,variant:"success",title:v.isConfirmed?"Transaction confirmed!":"Transaction pending!",description:v.isConfirmed?void 0:"Your transaction is pending! Please check block explorer for updates.",blockExplorerLink:v.blockExplorerLink,txnHash:v.txnHash})});return}case"error":{q({status:"error",isClosable:!0,duration:3e4,position:"bottom-right",render:x=>o.jsx(Hn,{...x,variant:"error",title:"Transaction failed!",description:v.message??"Please try again!",blockExplorerLink:v.blockExplorerLink,txnHash:v.txnHash,traceId:v.traceId})});return}}},[q,v]),l.useEffect(()=>{var x;V&&((x=A.current)==null||x.focus())},[t,V]),n?null:o.jsx(qo,{value:e,children:o.jsx(de,{m:0,display:"flex",children:o.jsxs(Ie,{alignItems:"stretch",flex:"1",spacing:"2.5",children:[o.jsxs(yn,{children:[o.jsx(pt,{ref:A,baseTokenSymbol:e.baseToken.symbol,quoteTokenSymbol:e.quoteToken.symbol,currentTokenImageURL:s==null?void 0:s({swapDirection:t,swapMode:a,pair:e}),onBuyTypeToggle:ae,direction:t,buyType:a,value:h,onValueChange:E,isInvalid:!R,step:t==="buy"&&a==="quote"?"0.01":"1",min:t==="buy"?z.minBuyAmount:1,isDisabled:n,rightElement:k?void 0:null,...Tn(R,M)}),o.jsx(kn,{presets:c,onPresetClick:U,isPresetsDisabled:ie||n})]}),o.jsxs(yn,{children:[o.jsx(gt,{ref:F,size:"sm",leftElement:o.jsx(ve,{fontSize:"xs",children:"Slippage %"}),leftElementProps:{color:Y},value:b,onValueChange:Q,isInvalid:!B,isDisabled:n,min:z.minSlippage,max:z.maxSlippage,step:.1,...Tn(B,M)}),o.jsx(kn,{presets:u,onPresetClick:ee,isPresetsDisabled:n})]}),o.jsxs(Ie,{alignItems:"stretch",flex:"1",spacing:"1",children:[o.jsxs(Me,{spacing:"1",children:[o.jsx(ba,{state:T||!I||C(h).eq(0)?"error":v.kind==="idle"||v.kind==="pending"?v.kind:"idle",chainId:e.chainId,type:t,onClick:N,isDisabled:n}),S?o.jsx(Da,{isSettingsOverwritten:g,data:m,onSubmit:y}):null]}),o.jsx(de,{fontSize:"xs",children:o.jsx(de,{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center",children:$[0]!==void 0?o.jsxs(ve,{color:O,fontSize:"xs",textAlign:"center",children:[$[0]==="invalid-amount"?"Invalid amount!":null,$[0]==="invalid-slippage"?"Invalid slippage!":null,$[0]==="min-slippage"?`Min. slippage is ${z.minSlippage}%!`:null,$[0]==="max-slippage"?`Max slippage is ${z.maxSlippage}%!`:null,$[0]==="invalid-amount-with-slippage"?"Invalid amount or slippage!":null,$[0]==="min-sell-amount"?`Min. sell amount is ${z.minSellAmount} ${e.quoteToken.symbol}`:null,$[0]==="min-buy-amount"?`Min. buy amount is ${z.minBuyAmount} ${e.quoteToken.symbol}`:null,$[0]==="not-enough-collateral"||$[0]==="not-enough-token"?o.jsxs(o.Fragment,{children:["Insufficient funds!",ue({value:t==="buy"?w:p,onPending:()=>null,onFailure:()=>null,onSuccess:x=>x===void 0?null:o.jsxs(o.Fragment,{children:[" ","(",Ke({number:x,significantDigits:{lt1:4,gte1:2},largeNumberSuffix:{threshold:"million",significantDigits:2}})," ",t==="buy"?e.quoteToken.symbol:e.baseToken.symbol," avail.)"]})})]}):null]}):r!==void 0||z.platformFeeInPercents?o.jsxs(Ie,{spacing:"0",children:[r!==void 0?o.jsxs(ve,{color:X,fontSize:"xs",textAlign:"center",children:["you ",t==="buy"&&a==="base"?"spend max.":"receive min."," ",o.jsxs(ve,{fontWeight:"semibold",color:G("gray.600","blue.300",M),children:[Ke({number:r,significantDigits:x=>x.lt(1)?4:x.lt(1e3)?2:0,largeNumberSuffix:{threshold:"million",significantDigits:2},addCommas:!0})," "]}),t==="buy"&&a==="quote"?e.baseToken.symbol:e.quoteToken.symbol,i!==void 0&&i>0?o.jsxs(ve,{children:[" ","(~",Ke({number:i,prefix:"$",significantDigits:x=>x.lt(1)?2:x.lt(10)?1:0,largeNumberSuffix:{threshold:"thousand",significantDigits:1},addCommas:!0}),")"]}):null]}):null,z.platformFeeInPercents?o.jsxs(ve,{color:X,fontSize:"2xs",textAlign:"center",opacity:.7,children:["platform fee:"," ",Ke({number:z.platformFeeInPercents*100,suffix:"%",significantDigits:1,addCommas:!0})]}):null]}):null})})]})]})})})},Oe="So11111111111111111111111111111111111111112",Qn=[Oe],Fa={buy:[.1,.25,.5,1,2,5].map(e=>({value:e,label:`${e}`})),sell:[10,20,25,50,75,100].map(e=>({value:e,label:`${e}%`}))},ja={buy:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`})),sell:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`}))},Xn="0.1",Ra="10000",hn=.005,Ge=e=>{const{swapDirection:n,swapMode:s,amount:t,price:a,decimals:r}=e;switch(n){case"buy":{switch(s){case"base":return H(C(a).times(t),r);case"quote":return H(C(t).dividedBy(a),r)}break}case"sell":return H(C(a).times(t),r)}},br=({pair:e,swapDirection:n,addHighlightAddress:s,removeHighlightAddress:t,widgetId:a})=>{const r=te(Yo),i=te(qe),c=te(Ve),u=te(Cn),h=sn(e.chainId),b=re(S=>S.getTokenBalance),d=re(S=>S.signTransaction),f=re(S=>S.connectedWallets.solana),T=Le(()=>f?f.adapter.getPublicKey():Promise.resolve(void 0),[f]),I=ue({value:T,onPending:()=>{},onFailure:()=>{},onSuccess:S=>S}),p=e.baseToken.decimals??9,w=e.quoteToken.decimals??9,B=l.useMemo(()=>({widgetId:a,buyQuoteAmount:Xn,buyBaseAmount:()=>{const S=Ge({amount:ye(Xn),swapDirection:"buy",swapMode:"quote",price:e.price,decimals:p});return S&&S.isNaN()===!1?new D(le(S,p)).toFixed(0,W.ROUND_DOWN):Ra},sellQuoteAmount:"0",baseTokenDecimals:p,quoteTokenDecimals:w,slippage:"5",minSlippage:.1,maxSlippage:100,minBuyAmount:.005,minSellAmount:.001,minPriorityFee:.002,defaultPriorityFee:0,platformFeeInPercents:hn,isSettingsEnabled:!1,isFrontRunningProtectionEnabled:!1,priorityFeePresets:[],buySwapModes:["quote"]}),[a,p,w,e.price]),R=se(f),N=se(h),v=se(B),L=l.useCallback(S=>b({chainId:S.chainId,tokenAddress:S.tokenAddress}).pipe(_e(g=>{if(g!==void 0)return le(g,S.decimals).toString()})),[b]),Z=l.useCallback(()=>L({chainId:e.chainId,tokenAddress:e.baseToken.address,decimals:e.baseToken.decimals??9}),[L,e.baseToken.address,e.baseToken.decimals,e.chainId]),oe=l.useCallback(()=>L({chainId:e.chainId,tokenAddress:e.quoteToken.address,decimals:e.quoteToken.decimals??9}),[L,e.chainId,e.quoteToken.address,e.quoteToken.decimals]),ie=l.useCallback(S=>Ge({...S,decimals:S.swapMode==="base"?p:w,price:e.price}),[e.price,p,w]),$=l.useCallback(async({slippage:S,amount:g,swapDirection:m,swapMode:y,traceId:k})=>{var M,X,O;const V=await((M=R.current)==null?void 0:M.adapter.getPublicKey());if(!V)return pe.idle;try{const Y=C(S),q=Qn.includes(e.quoteToken.address)?e.quoteToken.address:Qn.includes(e.baseToken.address)?e.baseToken.address:void 0,A=q===e.quoteToken.address?"quote":q===e.baseToken.address?"base":"no-fee";let F,_,E,U,Q;switch(m){case"buy":{switch(F=e.quoteToken.address,_=e.baseToken.address,y){case"base":return{kind:"error",message:"Buy base not supported!"};case"quote":{E=new D(H(g,v.current.quoteTokenDecimals)).toFixed(0,W.ROUND_DOWN),U=new D(Pe(Ge({swapDirection:m,swapMode:y,amount:g,price:e.price,decimals:v.current.baseTokenDecimals}),Y,!1)).toFixed(0,W.ROUND_DOWN);const me=A==="quote"?E:A==="base"?U:"0";Q=new D(me).times(hn).toFixed(0,W.ROUND_DOWN);break}}break}case"sell":{F=e.baseToken.address,_=e.quoteToken.address;const me=Ge({swapDirection:m,swapMode:y,amount:g,price:e.price,decimals:v.current.quoteTokenDecimals});E=new D(H(g,v.current.baseTokenDecimals)).toFixed(0,W.ROUND_DOWN),U=new D(Pe(me,Y,!1)).toFixed(0,W.ROUND_DOWN);const Ae=A==="quote"?me:A==="base"?E:"0";Q=new D(Ae).times(hn).toFixed(0,W.ROUND_DOWN);break}}const{token:ee,serializedTx:ae}=await r.meteoraSwapPrepareV1({mintFrom:F,mintTo:_,poolId:e.pairAddress,sender:V,amountIn:E,amountOut:U,traceId:k,feeAmount:Q,feeMintAddress:(A==="no-fee"?Oe:q)??Oe}),x=await d({chainId:e.chainId,txn:ae});if(!x)return{kind:"error",message:"Transaction signing failed"};const{transactionSignature:K,status:ce}=await r.meteoraSwapSubmitV1({token:ee,signedTransaction:x,traceId:k});return b({chainId:e.chainId,tokenAddress:e.quoteToken.address}),b({chainId:e.chainId,tokenAddress:e.baseToken.address}),{kind:"success",txnHash:K,blockExplorerLink:(O=(X=N.current)==null?void 0:X.txnsURL)==null?void 0:O.call(X,K),isConfirmed:ce==="SUCCESS",resetTxState:!0,resetSellAmount:!0}}catch(Y){const q=an(Y);if(q instanceof on)return pe.idle;i.error({event:{id:"initiateMeteoraSwapTransactionError",data:{traceId:k,error:q}}});let A=q.message;if(q instanceof En){const F=j.object({message:j.string()}).safeParse(q.data);F.success&&(A=F.data.message)}return{kind:"error",message:A,traceId:k}}},[R,e.quoteToken.address,e.baseToken.address,e.pairAddress,e.chainId,e.price,r,d,b,N,v,i]),z=l.useCallback(({swapDirection:S,swapMode:g,pair:m})=>{var y,k;return m.baseToken.address===Oe&&(S==="buy"&&g==="base"||S==="sell")||m.baseToken.address!==Oe&&S==="buy"&&g==="quote"?c(m.chainId):u({dsDataParams:(y=m.profile)!=null&&y.eti?{chainId:m.chainId,tokenAddress:m.baseToken.address,cacheKey:(k=m.profile)==null?void 0:k.imgKey}:void 0,cmsParams:m.cmsProfile?{size:{width:56,height:56},fit:"crop",assetId:m.cmsProfile.iconId}:void 0})},[c,u]);return l.useEffect(()=>{if(I)return s(I,"user"),()=>t(I)},[s,t,I]),o.jsx(un,{amountPresets:Fa,slippagePresets:ja,options:B,calculateCost:ie,getBaseTokenBalance:Z,getQuoteTokenBalance:oe,submitTransaction:$,swapDirection:n,children:o.jsx(dn,{pair:e,buildTokenImageURL:z})})},Ba={buy:[.1,.25,.5,1,2,5].map(e=>({value:e,label:`${e}`})),sell:[10,20,25,50,75,100].map(e=>({value:e,label:`${e}%`}))},Oa={buy:[.005,.01,.05,.1,.5,1].map(e=>({value:e,label:`${e}`})),sell:[10,20,25,50,75,100].map(e=>({value:e,label:`${e}%`}))},Ua={buy:[5,10,15,20,25,50].map(e=>({value:e,label:`${e}%`})),sell:[5,10,15,20,25,50].map(e=>({value:e,label:`${e}%`}))},Yn=e=>{switch(e){case"moonshot":case"moonshotsol":default:return"solana";case"moonshotevm":return"evm"}},Wa="10000",hr=({pair:e,swapDirection:n,addHighlightAddress:s,removeHighlightAddress:t})=>{const a=te(po),r=te(Js),i=te(Ve),c=te(so),u=te(qe),h=sn(e.chainId),b=re(m=>m.getTokenBalance),d=re(m=>m.signTransaction),f=re(m=>m.approveAmount),T=re(m=>m.connectedWallets),I=ot(e.chainId),p=I?T[I]:void 0,w=l.useMemo(()=>e.moonshot.curveType==="CONSTANT_PRODUCT_V1"?e.a==="moonshotevm"?new Hs:new qn:new Ln({config:{marketCapThreshold:C(e.moonshot.mcapThreshold),coefficientBMinimalUnits:parseInt(e.moonshot.coefB)}}),[e.moonshot.curveType,e.moonshot.mcapThreshold,e.moonshot.coefB,e.a]),B=l.useMemo(()=>{const m=Yn(e.a);let y;switch(m){case"solana":{y={buyQuoteAmount:"0.1",quoteTokenDecimals:9,minBuyAmount:.005,minSellAmount:.001,minPriorityFee:.002,defaultPriorityFee:0,isSettingsEnabled:!0,isFrontRunningProtectionEnabled:!1};break}case"evm":{y={buyQuoteAmount:"0.005",quoteTokenDecimals:18,minBuyAmount:.001,minSellAmount:5e-4,minPriorityFee:1e-4,defaultPriorityFee:0,isSettingsEnabled:!1,isFrontRunningProtectionEnabled:!1};break}}return{widgetId:"moonshot",buyBaseAmount:()=>{const k=a.calculateCost({amount:ye(typeof y.buyQuoteAmount=="string"?y.buyQuoteAmount:y.buyQuoteAmount()),buyType:"quote",direction:"buy",curvePosition:e.moonshot.curvePos,curve:w});return k&&k.isNaN()===!1?new D(le(k,w.getConfig().tokenDecimalsNr)).toString():Wa},sellQuoteAmount:"0",baseTokenDecimals:w.getConfig().tokenDecimalsNr,minSlippage:.1,maxSlippage:100,slippage:"15",buySwapModes:["base","quote"],adjustPercentageSellAmount:({sellAmount:k,percentage:V})=>V===100&&k.gt(1)?k.minus(1).toFixed(0,W.ROUND_DOWN):k.toFixed(0,W.ROUND_DOWN),priorityFeePresets:[{label:"0.002",value:.002},{label:"0.005",value:.005},{label:"0.01",value:.01},{label:"0.015",value:.015},{label:"0.02",value:.02}],...y}},[w,a,e.a,e.moonshot.curvePos]),R=se(p),N=se(w),v=se(B),L=se(h),Z=l.useCallback(m=>a.calculateCost({amount:C(m.amount),buyType:m.swapMode,direction:m.swapDirection,curve:w,curvePosition:e.moonshot.curvePos}),[w,a,e.moonshot.curvePos]),oe=l.useCallback(m=>b({chainId:m.chainId,tokenAddress:m.tokenAddress}).pipe(_e(y=>{if(y!==void 0)return le(y,m.decimals).toString()})),[b]),ie=l.useCallback(()=>oe({chainId:e.chainId,tokenAddress:e.baseToken.address,decimals:e.baseToken.decimals??w.getConfig().tokenDecimalsNr}),[w,oe,e.baseToken.address,e.baseToken.decimals,e.chainId]),$=l.useCallback(()=>oe({chainId:e.chainId,tokenAddress:e.quoteToken.address,decimals:e.quoteToken.decimals??w.getConfig().collateralDecimalsNr}),[w,oe,e.chainId,e.quoteToken.address,e.quoteToken.decimals]),z=l.useCallback(async({slippage:m,amount:y,swapDirection:k,swapMode:V,traceId:M,priorityFee:X,isFrontRunningProtectionEnabled:O})=>{var q,A,F;const Y=await((q=R.current)==null?void 0:q.adapter.getPublicKey());if(!Y)return pe.idle;try{const _=C(m).multipliedBy(100).toNumber(),E=C(y),U=k==="buy"&&V==="quote"?a.getTokensNumberFromCollateral({curvePosition:C(e.moonshot.curvePos),direction:k,amount:E,curve:N.current}):H(E,v.current.baseTokenDecimals),Q=k==="buy"&&V==="quote"?H(E,v.current.quoteTokenDecimals):a.calculateCost({curvePosition:C(e.moonshot.curvePos),direction:k,buyType:V,amount:E,curve:N.current});if(!U||!Q)return{kind:"error",message:"Can not calculate the amount",traceId:M};const ee=H(C(X),v.current.quoteTokenDecimals),ae=await r.txPrepare({traceId:M,chainId:e.chainId,direction:k,type:k==="sell"?"base":V,creatorPK:Y,amount:new D(U).toString(),collateralAmount:new D(Q).toFixed(0,W.ROUND_DOWN),slippageBps:_,mintAddress:e.baseToken.address,curveType:N.current.getConfig().type,coefB:N.current.getConfig().coefficientBMinimalUnits,priority:ee.gt(0)?{frontRunningProtection:O,priorityTipAmount:ee.toString()}:void 0});if(k==="sell"){const ce=fo(e.chainId);ce&&await f({chainId:e.chainId,amount:new D(U).toString(),tokenAddress:e.baseToken.address,factoryAddress:ce})}const x=await d({chainId:e.chainId,txn:ae.transaction});if(!x)return{kind:"error",message:"Transaction signing failed"};const K=await r.txSubmit({traceId:M,chainId:e.chainId,direction:k,signedTransaction:x,token:ae.token});return K.status==="success"||K.status==="pending"?(b({chainId:e.chainId,tokenAddress:e.quoteToken.address}),b({chainId:e.chainId,tokenAddress:e.baseToken.address}),{kind:"success",txnHash:K.transactionSignature,blockExplorerLink:(F=(A=L.current)==null?void 0:A.txnsURL)==null?void 0:F.call(A,K.transactionSignature),isConfirmed:K.status==="success",resetTxState:!0,resetSellAmount:!0}):{kind:"error",message:"Transaction failed",traceId:M,txnHash:K.transactionSignature}}catch(_){const E=an(_);return E instanceof on?pe.idle:(u.error({event:{id:"initiateTransactionError",data:{traceId:M,error:E}}}),E instanceof Qs||E instanceof Xs||E instanceof Ys?{kind:"error",message:"Client/server mismatch, please refresh the page and try again!"}:E instanceof Zs?{kind:"error",message:E.message,traceId:M}:{kind:"error",resetTxState:!0})}},[f,L,N,b,u,r,a,v,e.baseToken.address,e.chainId,e.moonshot.curvePos,e.quoteToken.address,d,R]),S=l.useCallback(({swapDirection:m,swapMode:y,pair:k})=>m==="buy"&&y==="quote"?i(k.chainId==="base"||k.chainId==="basesepolia"?"ethereum":k.chainId):k.cmsProfile?c({assetId:k.cmsProfile.iconId,size:"lg",fit:"crop"}):void 0,[i,c]),g=Le(async()=>p==null?void 0:p.adapter.getPublicKey(),[p]);return l.useEffect(()=>ue({value:g,onSuccess:m=>{if(m)return s(m,"user"),()=>t(m)},onFailure:()=>{},onPending:()=>{}}),[s,t,g]),![Ln.DEFEAULT_CONFIG.type,qn.DEFEAULT_CONFIG.type].includes(e.moonshot.curveType)||e.moonshot.progress>=100?null:o.jsx(un,{amountPresets:Yn(e.a)==="solana"?Ba:Oa,slippagePresets:Ua,options:B,calculateCost:Z,getBaseTokenBalance:ie,getQuoteTokenBalance:$,submitTransaction:z,swapDirection:n,children:o.jsx(dn,{pair:e,buildTokenImageURL:S})})},Ue="So11111111111111111111111111111111111111112",Zn=[Ue],Ma={buy:[.1,.25,.5,1,2,5].map(e=>({value:e,label:`${e}`})),sell:[10,20,25,50,75,100].map(e=>({value:e,label:`${e}%`}))},qa={buy:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`})),sell:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`}))},Jn="0.1",La="10000",He=.005,je=e=>{const{swapDirection:n,swapMode:s,amount:t,price:a,decimals:r}=e;switch(n){case"buy":{switch(s){case"base":return H(C(a).times(t),r);case"quote":return H(C(t).dividedBy(a),r)}break}case"sell":return H(C(a).times(t),r)}},gr=({pair:e,swapDirection:n,addHighlightAddress:s,removeHighlightAddress:t,widgetId:a})=>{const r=te(na),i=te(qe),c=te(Ve),u=te(Cn),h=sn(e.chainId),b=re(S=>S.getTokenBalance),d=re(S=>S.signTransaction),f=re(S=>S.connectedWallets.solana),T=Le(()=>f?f.adapter.getPublicKey():Promise.resolve(void 0),[f]),I=ue({value:T,onPending:()=>{},onFailure:()=>{},onSuccess:S=>S}),p=e.baseToken.decimals??9,w=e.quoteToken.decimals??9,B=l.useMemo(()=>({widgetId:a,buyQuoteAmount:Jn,buyBaseAmount:()=>{const S=je({amount:ye(Jn),swapDirection:"buy",swapMode:"quote",price:e.price,decimals:p});return S&&S.isNaN()===!1?new D(le(S,p)).toFixed(0,W.ROUND_DOWN):La},sellQuoteAmount:"0",baseTokenDecimals:p,quoteTokenDecimals:w,slippage:"5",minSlippage:.1,maxSlippage:100,minBuyAmount:.005,minSellAmount:.001,minPriorityFee:.002,defaultPriorityFee:0,platformFeeInPercents:He,isSettingsEnabled:!0,isFrontRunningProtectionEnabled:!1,priorityFeePresets:[{label:"0.002",value:.002},{label:"0.005",value:.005},{label:"0.01",value:.01},{label:"0.015",value:.015},{label:"0.02",value:.02}],buySwapModes:["base","quote"]}),[a,p,w,e.price]),R=se(f),N=se(h),v=se(B),L=l.useCallback(S=>b({chainId:S.chainId,tokenAddress:S.tokenAddress}).pipe(_e(g=>{if(g!==void 0)return le(g,S.decimals).toString()})),[b]),Z=l.useCallback(()=>L({chainId:e.chainId,tokenAddress:e.baseToken.address,decimals:e.baseToken.decimals??9}),[L,e.baseToken.address,e.baseToken.decimals,e.chainId]),oe=l.useCallback(()=>L({chainId:e.chainId,tokenAddress:e.quoteToken.address,decimals:e.quoteToken.decimals??9}),[L,e.chainId,e.quoteToken.address,e.quoteToken.decimals]),ie=l.useCallback(S=>je({...S,decimals:S.swapMode==="base"?p:w,price:e.price}),[e.price,p,w]),$=l.useCallback(async({slippage:S,amount:g,swapDirection:m,swapMode:y,traceId:k,isFrontRunningProtectionEnabled:V,priorityFee:M})=>{var O,Y,q;const X=await((O=R.current)==null?void 0:O.adapter.getPublicKey());if(!X)return pe.idle;try{const A=C(S),F=A.multipliedBy(100).toNumber(),_=Zn.includes(e.quoteToken.address)?e.quoteToken.address:Zn.includes(e.baseToken.address)?e.baseToken.address:void 0,E=_===e.quoteToken.address?"quote":_===e.baseToken.address?"base":"no-fee",U=H(C(M),v.current.quoteTokenDecimals);let Q,ee,ae,x,K,ce;switch(m){case"buy":{switch(Q=e.quoteToken.address,ee=e.baseToken.address,y){case"base":{ae="EXACT_OUT";const xe=je({swapDirection:m,swapMode:y,amount:g,price:e.price,decimals:v.current.quoteTokenDecimals});K=new D(H(g,v.current.baseTokenDecimals)).toFixed(0,W.ROUND_DOWN),x=new D(Pe(xe,A,!0)).toFixed(0,W.ROUND_DOWN);const Fe=E==="quote"?xe:E==="base"?K:"0";ce=new D(Fe).times(He).toFixed(0,W.ROUND_DOWN);break}case"quote":{ae="EXACT_IN",x=new D(H(g,v.current.quoteTokenDecimals)).toFixed(0,W.ROUND_DOWN),K=new D(Pe(je({swapDirection:m,swapMode:y,amount:g,price:e.price,decimals:v.current.baseTokenDecimals}),A,!1)).toFixed(0,W.ROUND_DOWN);const xe=E==="quote"?x:E==="base"?K:"0";ce=new D(xe).times(He).toFixed(0,W.ROUND_DOWN);break}}break}case"sell":{Q=e.baseToken.address,ee=e.quoteToken.address,ae="EXACT_IN";const xe=je({swapDirection:m,swapMode:y,amount:g,price:e.price,decimals:v.current.quoteTokenDecimals});x=new D(H(g,v.current.baseTokenDecimals)).toFixed(0,W.ROUND_DOWN),K=new D(Pe(xe,A,!1)).toFixed(0,W.ROUND_DOWN);const Fe=E==="quote"?xe:E==="base"?x:"0";ce=new D(Fe).times(He).toFixed(0,W.ROUND_DOWN);break}}const{token:me,serializedTx:Ae}=await r.raydiumSwapPrepareV1({mintFrom:Q,mintTo:ee,poolId:e.pairAddress,sender:X,slippageBps:F,amountIn:x,amountOut:K,swapType:ae,traceId:k,feeAmount:ce,feeMintAddress:(E==="no-fee"?Ue:_)??Ue,priority:U.gt(0)?{frontRunningProtection:V,priorityTipAmount:U.toString()}:void 0}),Se=await d({chainId:e.chainId,txn:Ae});if(!Se)return{kind:"error",message:"Transaction signing failed"};const{transactionSignature:J,status:be}=await r.raydiumSwapSubmitV1({token:me,signedTransaction:Se,traceId:k});return b({chainId:e.chainId,tokenAddress:e.quoteToken.address}),b({chainId:e.chainId,tokenAddress:e.baseToken.address}),{kind:"success",txnHash:J,blockExplorerLink:(q=(Y=N.current)==null?void 0:Y.txnsURL)==null?void 0:q.call(Y,J),isConfirmed:be==="SUCCESS",resetTxState:!0,resetSellAmount:!0}}catch(A){const F=an(A);if(F instanceof on)return pe.idle;i.error({event:{id:"initiateRaydiumSwapTransactionError",data:{traceId:k,error:F}}});let _=F.message;if(F instanceof En){const E=j.object({message:j.string()}).safeParse(F.data);E.success&&(_=E.data.message)}return{kind:"error",message:_,traceId:k}}},[R,e.quoteToken.address,e.baseToken.address,e.pairAddress,e.chainId,e.price,r,d,b,N,v,i]),z=l.useCallback(({swapDirection:S,swapMode:g,pair:m})=>{var y,k;return m.baseToken.address===Ue&&(S==="buy"&&g==="base"||S==="sell")||m.baseToken.address!==Ue&&S==="buy"&&g==="quote"?c(m.chainId):u({dsDataParams:(y=m.profile)!=null&&y.eti?{chainId:m.chainId,tokenAddress:m.baseToken.address,cacheKey:(k=m.profile)==null?void 0:k.imgKey}:void 0,cmsParams:m.cmsProfile?{size:{width:56,height:56},fit:"crop",assetId:m.cmsProfile.iconId}:void 0})},[c,u]);return l.useEffect(()=>{if(I)return s(I,"user"),()=>t(I)},[s,t,I]),o.jsx(un,{amountPresets:Ma,slippagePresets:qa,options:B,calculateCost:ie,getBaseTokenBalance:Z,getQuoteTokenBalance:oe,submitTransaction:$,swapDirection:n,children:o.jsx(dn,{pair:e,buildTokenImageURL:z})})},We="0x4200000000000000000000000000000000000006",Ye="0x0000000000000000000000000000000000000000",Va={buy:[.005,.01,.05,.1,.5,1].map(e=>({value:e,label:`${e}`})),sell:[10,20,25,50,75,100].map(e=>({value:e,label:`${e}%`}))},$a={buy:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`})),sell:[1,2,3,5,10].map(e=>({value:e,label:`${e}%`}))},et="0.005",za="10000",Qe=.005,Xe=e=>e===We?Ye:e,Re=e=>{const{swapDirection:n,swapMode:s,amount:t,price:a,decimals:r}=e;switch(n){case"buy":{switch(s){case"base":return H(C(a).times(t),r);case"quote":return H(C(t).dividedBy(a),r)}break}case"sell":return H(C(a).times(t),r)}},pr=({pair:e,swapDirection:n,addHighlightAddress:s,removeHighlightAddress:t,widgetId:a})=>{const r=te(aa),i=te(qe),c=te(Ve),u=te(Cn),h=sn(e.chainId),b=re(g=>g.getTokenBalance),d=re(g=>g.approveAmount),f=re(g=>g.signTransaction),T=re(g=>g.connectedWallets.evm),I=Le(()=>T?T.adapter.getPublicKey():Promise.resolve(void 0),[T]),p=ue({value:I,onPending:()=>{},onFailure:()=>{},onSuccess:g=>g}),w=e.baseToken.decimals??18,B=e.quoteToken.decimals??18,R=l.useMemo(()=>({widgetId:a,buyQuoteAmount:et,buyBaseAmount:()=>{const g=Re({amount:ye(et),swapDirection:"buy",swapMode:"quote",price:e.price,decimals:w});return g&&g.isNaN()===!1?new D(le(g,w)).toFixed(0,W.ROUND_DOWN):za},sellQuoteAmount:"0",baseTokenDecimals:w,quoteTokenDecimals:B,slippage:"5",minSlippage:.1,maxSlippage:100,minBuyAmount:.001,minSellAmount:5e-4,minPriorityFee:1e-4,defaultPriorityFee:0,platformFeeInPercents:Qe,isSettingsEnabled:!1,isFrontRunningProtectionEnabled:!1,priorityFeePresets:[],buySwapModes:["quote","base"]}),[a,w,B,e.price]),N=se(T),v=se(h),L=se(R),Z=l.useCallback(g=>b({chainId:g.chainId,tokenAddress:g.tokenAddress}).pipe(_e(m=>{if(m!==void 0)return le(m,g.decimals).toString()})),[b]),oe=l.useCallback(()=>Z({chainId:e.chainId,tokenAddress:e.baseToken.address,decimals:e.baseToken.decimals??18}),[Z,e.baseToken.address,e.baseToken.decimals,e.chainId]),ie=l.useCallback(()=>Z({chainId:e.chainId,tokenAddress:e.quoteToken.address,decimals:e.quoteToken.decimals??18}),[Z,e.chainId,e.quoteToken.address,e.quoteToken.decimals]),$=l.useCallback(g=>Re({...g,decimals:g.swapMode==="base"?w:B,price:e.price}),[e.price,w,B]),z=l.useCallback(async({slippage:g,amount:m,swapDirection:y,swapMode:k,traceId:V})=>{var X,O,Y;const M=await((X=N.current)==null?void 0:X.adapter.getPublicKey());if(!M)return pe.idle;try{const q=C(g),A=q.multipliedBy(100).toNumber();let F,_,E,U,Q,ee,ae,x;switch(e.quoteToken.address===We?(F=Ye,_="quote"):e.baseToken.address===We?(F=Ye,_="base"):(F=Ye,_="no-fee"),y){case"buy":{switch(E=Xe(e.quoteToken.address),U=Xe(e.baseToken.address),k){case"base":{x="EXACT_OUT";const J=Re({swapDirection:y,swapMode:k,amount:m,price:e.price,decimals:L.current.quoteTokenDecimals});ee=new D(H(m,L.current.baseTokenDecimals)).toFixed(0,W.ROUND_DOWN),Q=new D(Pe(J,q,!0)).toFixed(0,W.ROUND_DOWN);const be=_==="quote"?J:_==="base"?ee:"0";ae=new D(be).times(Qe).toFixed(0,W.ROUND_DOWN);break}case"quote":{x="EXACT_IN",Q=new D(H(m,L.current.quoteTokenDecimals)).toFixed(0,W.ROUND_DOWN),ee=new D(Pe(Re({swapDirection:y,swapMode:k,amount:m,price:e.price,decimals:L.current.baseTokenDecimals}),q,!1)).toFixed(0,W.ROUND_DOWN);const J=_==="quote"?Q:_==="base"?ee:"0";ae=new D(J).times(Qe).toFixed(0,W.ROUND_DOWN);break}}break}case"sell":{x="EXACT_IN",E=Xe(e.baseToken.address),U=Xe(e.quoteToken.address);const J=Re({swapDirection:y,swapMode:k,amount:m,price:e.price,decimals:L.current.quoteTokenDecimals});Q=new D(H(m,L.current.baseTokenDecimals)).toFixed(0,W.ROUND_DOWN),ee=new D(Pe(J,q,!1)).toFixed(0,W.ROUND_DOWN);const be=_==="quote"?J:_==="base"?Q:"0";ae=new D(be).times(Qe).toFixed(0,W.ROUND_DOWN);break}}const{token:K,serializedTx:ce}=await r.uniswapBaseSwapPrepareV1({mintFrom:E,mintTo:U,poolId:e.pairAddress,sender:M,amountIn:Q,amountOut:ee,traceId:V,feeAmount:ae,slippageBps:A,swapType:x,feeMintAddress:F});if(y==="sell"){const J=la(e.chainId);J&&await d({chainId:e.chainId,amount:new D(Q).toString(),tokenAddress:e.baseToken.address,factoryAddress:J})}const me=await f({chainId:e.chainId,txn:ce});if(!me)return{kind:"error",message:"Transaction signing failed"};const{transactionSignature:Ae,status:Se}=await r.uniswapBaseSwapSubmitV1({token:K,signedTransaction:me,traceId:V});return b({chainId:e.chainId,tokenAddress:e.quoteToken.address}),b({chainId:e.chainId,tokenAddress:e.baseToken.address}),{kind:"success",txnHash:Ae,blockExplorerLink:(Y=(O=v.current)==null?void 0:O.txnsURL)==null?void 0:Y.call(O,Ae),isConfirmed:Se==="SUCCESS",resetTxState:!0,resetSellAmount:!0}}catch(q){const A=an(q);if(A instanceof on)return pe.idle;i.error({event:{id:"initiateUniswapSwapTransactionError",data:{traceId:V,error:A}}});let F=A.message;if(A instanceof En){const _=j.object({message:j.string()}).safeParse(A.data);_.success&&(F=_.data.message)}return{kind:"error",message:F,traceId:V}}},[N,e.quoteToken.address,e.baseToken.address,e.pairAddress,e.chainId,e.price,r,f,b,v,L,d,i]),S=l.useCallback(({swapDirection:g,swapMode:m,pair:y})=>{var V,M;const k=y.chainId==="base"||y.chainId==="basesepolia"?"ethereum":y.chainId;return y.baseToken.address===We&&(g==="buy"&&m==="base"||g==="sell")||y.baseToken.address!==We&&g==="buy"&&m==="quote"?c(k):u({dsDataParams:(V=y.profile)!=null&&V.eti?{chainId:y.chainId,tokenAddress:y.baseToken.address,cacheKey:(M=y.profile)==null?void 0:M.imgKey}:void 0,cmsParams:y.cmsProfile?{size:{width:56,height:56},fit:"crop",assetId:y.cmsProfile.iconId}:void 0})},[c,u]);return l.useEffect(()=>{if(p)return s(p,"user"),()=>t(p)},[s,t,p]),o.jsx(un,{amountPresets:Va,slippagePresets:$a,options:R,calculateCost:$,getBaseTokenBalance:oe,getQuoteTokenBalance:ie,submitTransaction:z,swapDirection:n,children:o.jsx(dn,{pair:e,buildTokenImageURL:S})})},fr=we({env:Ne()},({env:e})=>n=>e.DS_WEB_METEORA_SWAP_WIDGET_ENABLED===!0&&ra(n)),Sr=we({env:Ne()},({env:e})=>n=>e.DS_WEB_RAYDIUM_SWAP_WIDGET_ENABLED===!0&&ia(n)),yr=we({env:Ne()},({env:e})=>n=>e.DS_WEB_UNISWAP_SWAP_WIDGET_ENABLED===!0&&ca(n));export{lr as A,er as B,sr as C,ir as D,Lo as E,Sn as F,Vo as G,$o as H,Dn as I,Go as J,Mo as K,qo as L,hr as M,ur as P,gr as R,jo as T,pr as U,cr as W,Ro as a,Bo as b,br as c,fr as d,yr as e,$n as f,Wo as g,Nn as h,Sr as i,zo as j,zn as k,Kn as l,po as m,pt as n,lt as o,rr as p,dr as q,ua as r,mr as s,fa as t,So as u,tr as v,ht as w,nr as x,Ja as y,ar as z};
